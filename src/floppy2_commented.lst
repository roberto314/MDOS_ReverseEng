 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 1 - 2026-01-23 11:21:24


       1/       0 :                     ; Ready to assemble with asl. binary matches original
       2/       0 :                     
       3/       0 :                              include "mdoseq.inc"
(1)    1/       0 :                     ; MDOS VERSION 03.00 -- SYSTEM EQUATE FILE -- JULY 25.1978
(1)    2/       0 :                     ; 
(1)    3/       0 :                     ; 
(1)    4/       0 :                     ; DEFINE TYPE OF MDOS--RESIDENT MDOS ONLY
(1)    5/       0 :                     ; 0000 A MDOSF$ EQU 0      .0 => MDOS, 1 => OEM MDOS
(1)    6/       0 :                     ; 0000 A MDOS9$ EQU 0      .0 => MDOS, 1 => MDOS09
(1)    7/       0 :                     
(1)    8/       0 :                     ; SKIP2 MACRO
(1)    9/       0 :                     ; THE GENERATED BYTE IS A "COMPARE INDEX IMMEDIATE".
(1)   10/       0 :                     ; THE EXECUTION OF THE BYTE WILL CHANGE THE CONDITION CODE
(1)   11/       0 :                     ; NO REGISTERS ARE AFFECTED. THUS. A ONE BYTE INSTRUCTION
(1)   12/       0 :                     ; IS FORMED THAT SKIPS FORWARD TWO BYTES.
(1)   13/       0 :                     
(1)   14/       0 :                     SKIP2    MACRO
(1)   15/       0 :                              FCB $8C
(1)   16/       0 :                              ENDM
(1)   17/       0 :                     
(1)   18/       0 :                     ; SKIP1 MACRO
(1)   19/       0 :                     ; THE SAME CONCEPT AS THE "SKIP2" MACRO IS USED, EXCEPT THE
(1)   20/       0 :                     ; A "BIT TEST ACCUMULATOR A IMMEDIATE" OP CODE IS GENERATED
(1)   21/       0 :                     
(1)   22/       0 :                     SKIP1    MACRO
(1)   23/       0 :                              FCB $85
(1)   24/       0 :                              ENDM
(1)   25/       0 :                     
(1)   26/       0 :                     ; SCALL MACRO (SYSTEM FUNCTION CALL)
(1)   27/       0 :                     SCALL    MACRO PAR
(1)   28/       0 :                              SWI
(1)   29/       0 :                              FCB  PAR
(1)   30/       0 :                              ENDM
(1)   31/       0 :                     ;
(1)   32/       0 :                     ; SYSCALLS USED
(1)   33/       0 :                     ; SYSTEM FUNCTION DEFINITION
(1)   34/       0 :                     
(1)   35/       0 : =$0                  RESRV1   EQU  $0 ; RESERVE A DEVICE
(1)   36/       0 : =$1                  RELES1   EQU  $1 ; RELEASE A DEVICE
(1)   37/       0 : =$2                  OPEN1    EQU  $2 ; OPEN A FILE
(1)   38/       0 : =$3                  CLOSE1   EQU  $3 ; CLOSE A FILE
(1)   39/       0 : =$4                  GETRC1   EQU  $4 ; READ A RECORD
(1)   40/       0 : =$5                  PUTRC1   EQU  $5 ; WRITE A RECORD
(1)   41/       0 : =$6                  REWND1   EQU  $6 ; POSITION TO BEGINNING OF FILE
(1)   42/       0 : =$7                  GETLS1   EQU  $7 ; READ LOGICAL SECTOR
(1)   43/       0 : =$8                  PUTLS1   EQU  $8 ; WRITE LOGICAL SECTOR
(1)   44/       0 : =$9                  KEYIN1   EQU  $9 ; CONSOLE INPUT
(1)   45/       0 : =$A                  DSPLY1   EQU  $A ; CONSOLE OUTPUT (TERM W/ CR)
(1)   46/       0 : =$B                  DSPLX1   EQU  $B ; CONSOLE OUTPUT (TERM W/ E01)
(1)   47/       0 : =$C                  DSPLZ1   EQU  $C ; CONSOLE OUTPUT (TERM W/ EOT, NO CHECK)
(1)   48/       0 : =$D                  CKBRK1   EQU  $D ; CHECK CONSOLE FOR BREAK KEY
(1)   49/       0 : =$E                  DREAD1   EQU  $E ; EROM DISK READ
(1)   50/       0 : =$F                  DWRIT1   EQU  $F ; EROM DISK WRITE
(1)   51/       0 : =$10                 MOVE1    EQU $10 ; MOVE A STRING
(1)   52/       0 : =$11                 CMPAR1   EQU $11 ; COMPARE STRINGS
(1)   53/       0 : =$12                 STCHB1   EQU $12 ; STORE BLANKS
(1)   54/       0 : =$13                 STCHR1   EQU $13 ; STORE CHARACTERS
(1)   55/       0 : =$14                 ALPHA1   EQU $14 ; CHECK ALPHABETIC CHARACTER
(1)   56/       0 : =$15                 NUMD1    EQU $15 ; CHECK DECIMAL DIGIT
(1)   57/       0 : =$16                 ADDAM1   EQU $16 ; INCREMENT MEMORY (DOUBLE BYTE) BY
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm(mdoseq.inc) - Page 2 - 2026-01-23 11:21:24


(1)   58/       0 : =$17                 SUBAM1   EQU $17 ; DECREMENT MEMORY (DOUBLE BYTE) BY
(1)   59/       0 : =$18                 MMA1     EQU $18 ; MULTIPLY (SHIFT LEFT) MEMORY BY A
(1)   60/       0 : =$19                 DMA1     EQU $19 ; DIVIDE (SHIFT RIGHT) MEMORY BY A
(1)   61/       0 : =$1A                 MDENT1   EQU $1A ; ENTER MDOS WITHOUT RELOADING
(1)   62/       0 : =$1B                 LOAD1    EQU $1B ; LOAD A FILE FROM DISK
(1)   63/       0 : =$1C                 DIRSM1   EQU $1C ; DIRECTORY SEARCH AND MODIFY
(1)   64/       0 : =$1D                 PFNAM1   EQU $1D ; PROCESS FILE NAME
(1)   65/       0 : =$1E                 ALUSM1   EQU $1E ; ALLOCATE USER MEMORY
(1)   66/       0 : =$1F                 CHANG1   EQU $1F ; CHANGE NAME/ATTRIBUTES
(1)   67/       0 : =$20                 MDERR1   EQU $20 ; MDOS ERROR MESSAGE HANDLER
(1)   68/       0 : =$21                 ALLOC1   EQU $21 ; ALLOCATE DISK SPACE
(1)   69/       0 : =$22                 DEALC1   EQU $22 ; RETURN DISK SPACE
(1)   70/       0 : =$23                 EWORD1   EQU $23 ; SET ERROR STATUS WORD FOR CHAIN
(1)   71/       0 : =$24                 TXBA1    EQU $24 ; TRANSFER X TO B,A
(1)   72/       0 : =$25                 TBAX1    EQU $25 ; TRANSFER B,A TO X
(1)   73/       0 : =$26                 XBAX1    EQU $26 ; EXCHANGE B,A AND X
(1)   74/       0 : =$27                 ADBX1    EQU $27 ; ADD B TO X
(1)   75/       0 : =$28                 ADAX1    EQU $28 ; ADD A TO X
(1)   76/       0 : =$29                 ADDAX1   EQU $29 ; ADD B,A TO X
(1)   77/       0 : =$2A                 ADXBA1   EQU $2A ; ADD X TO B,A
(1)   78/       0 : =$2B                 SUBX1    EQU $2B ; SUBTRACT B FROM X
(1)   79/       0 : =$2C                 SUAX1    EQU $2C ; SUBTRACT A FROM X
(1)   80/       0 : =$2D                 SUBAX1   EQU $2D ; SUBTRACT B,A FROM X
(1)   81/       0 : =$2E                 SUXBA1   EQU $2E ; SUBTRACT X FROM B,A
(1)   82/       0 : =$2F                 CPBAX1   EQU $2F ; COMPARE B.A TO X
(1)   83/       0 : =$30                 ASRX1    EQU $30 ; SHIFT X RIGHT (ARITHMETIC)
(1)   84/       0 : =$31                 ASLX1    EQU $31 ; SHIFT X LEFT (ARITHMETIC/LOGICAL)
(1)   85/       0 : =$32                 PSHX1    EQU $32 ; PUSH X ON STACK
(1)   86/       0 : =$33                 PULX1    EQU $33 ; PULL X FROM STACK
(1)   87/       0 : =$34                 PRINT1   EQU $34 ; PRINT-TERMINATE WITH CR
(1)   88/       0 : =$35                 PRINX1   EQU $35 ; PRINT-TERMINATE WITH EOT
(1)   89/       0 : =$36                 GETFD1   EQU $36 ; READ FDR (RESIDENT MDOS ONLY)
(1)   90/       0 : =$37                 PUTFD1   EQU $37 ; WRITE FDR (RESIDENT MDOS ONLY)
(1)   91/       0 : =$38                 PUTEF1   EQU $38 ; WRITE EOF (RESIDENT MDOS ONLY)
(1)   92/       0 : =$39                 EREAD1   EQU $39 ; DISK READ W/ ERR RETN
(1)   93/       0 : =$3A                 EWRIT1   EQU $3A ; DISK WRITE W/ ERR RETN
(1)   94/       0 : =$3B                 MREAD1   EQU $3B ; MULTIPLE SECTOR READ
(1)   95/       0 : =$3C                 MWRIT1   EQU $3C ; MULTIPLE SECTOR WRITE
(1)   96/       0 : =$3D                 MERED1   EQU $3D ; MULTIPLE SECTOR READ W/ ERR RETUR
(1)   97/       0 : =$3E                 MEWRT1   EQU $3E ; MULTIPLE SECTOR WRITE W/ ERR RETU
(1)   98/       0 : =$3F                 BOOT1    EQU $3F ; RELOAD MDOS
(1)   99/       0 :                     
(1)  100/       0 :                     ; 
(1)  101/       0 :                     ; ASCII Control Characters
(1)  102/       0 :                     ;
(1)  103/       0 : =$0                  NULL     EQU  $0 ; NULL
(1)  104/       0 : =$1                  SOH      EQU  $1 ; START OF HEADING
(1)  105/       0 : =$2                  STX      EQU  $2 ; START OF TEXT
(1)  106/       0 : =$3                  ETX      EQU  $3 ; END OF TEXT
(1)  107/       0 : =$4                  EDT      EQU  $4 ; END OF TRANSMISSION
(1)  108/       0 : =$5                  ENG      EQU  $5 ; ENGUIRY (WRU - WHO ARE YOU)
(1)  109/       0 : =$6                  ACK      EQU  $6 ; ACKNOWLEDGE
(1)  110/       0 : =$7                  BEL      EQU  $7 ; BELL
(1)  111/       0 : =$8                  BS       EQU  $8 ; BACKSPACE
(1)  112/       0 : =$9                  HT       EQU  $9 ; HORIZONTAL TAB
(1)  113/       0 : =$A                  LF       EQU  $A ; LINE FEED
(1)  114/       0 : =$B                  VT       EQU  $B ; VERTICAL TAB
(1)  115/       0 : =$C                  FF       EQU  $C ; FORM FEED
(1)  116/       0 : =$D                  CR       EQU  $D ; CARRIAGE RETURN
(1)  117/       0 : =$E                  SO       EQU  $E ; SHIFT OUT
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm(mdoseq.inc) - Page 3 - 2026-01-23 11:21:24


(1)  118/       0 : =$F                  SI       EQU  $F ; SHIFT IN
(1)  119/       0 : =$10                 DLE      EQU $10 ; DATA LINK ESCAPE
(1)  120/       0 : =$11                 DC1      EQU $11 ; DEVICE CONTROL 1
(1)  121/       0 : =$12                 DC2      EQU $12 ; DEVICE CONTROL 2
(1)  122/       0 : =$13                 DC3      EQU $13 ; DEVICE CONTROL 4
(1)  123/       0 : =$14                 DC4      EQU $14 ; DEVICE CONTROL 4
(1)  124/       0 : =$15                 NAK      EQU $15 ; NEGATIVE ACKNOWLEDGe
(1)  125/       0 : =$16                 SYN      EQU $16 ; SYNCHRONOUS IDLE
(1)  126/       0 : =$17                 ETB      EQU $17 ; END OF TRANSMISSION BLOCK
(1)  127/       0 : =$18                 CAN      EQU $18 ; CANCEL
(1)  128/       0 : =$19                 EM       EQU $19 ; END OF MEDIUM
(1)  129/       0 : =$1A                 SUB      EQU $1A ; SUBSTITUTE
(1)  130/       0 : =$1B                 ESC      EQU $1B ; ESCAPE
(1)  131/       0 : =$1C                 FS       EQU $1C ; FILE SEPARATOR
(1)  132/       0 : =$1D                 GS       EQU $1D ; GROUP SEPARATOR
(1)  133/       0 : =$1E                 RS       EQU $1E ; RECORD SEPARATOR
(1)  134/       0 : =$1F                 US       EQU $1F ; UNIT SEPARATOR
(1)  135/       0 : =$20                 SPACE    EQU $20 ; SPACE (WORD SEPARATOR)
(1)  136/       0 : =$7F                 RUBOUT   EQU $7F ; DELETE (RUB OUT)
(1)  137/       0 :                     
(1)  138/       0 :                     ;
(1)  139/       0 :                     ; Special Character Equates
(1)  140/       0 :                     ; 
(1)  141/       0 : ='.'                 SUFDLM   EQU '.'  ; SUFFIX DELIMETER
(1)  142/       0 : =';'                 OPTDLM   EQU ';'  ; OPTIONS DELIMETER
(1)  143/       0 : =':'                 DRVDLM   EQU ':'  ; LOGICAL DRIVER DELIMETER
(1)  144/       0 : ='#'                 DEVDLM   EQU '#'  ; GENERIC DEVICE NAME DELIMETER
(1)  145/       0 : ='*'                 FAMDLM   EQU '*'  ; FAMILY NAME/SUFFIX DELIMETER
(1)  146/       0 :                     ;E$FATL   EQU 1!<7 ; FATAL ERROR BIT 
(1)  147/       0 :                     
(1)  148/       0 :                     ;
(1)  149/       0 :                     ; MDOS SECTOR Equates
(1)  150/       0 :                     ;
(1)  151/       0 : =$0                  SCsDID   EQU 0   ; DISK ID PHYSICAL SECTOR NUMBER
(1)  152/       0 : =$1                  SCsCAT   EQU 1   ; CLUSTER ALLOCATION TABLE PHSYICAL
(1)  153/       0 : =$2                  SCsLOK   EQU 2   ; LOCKOUT CLUSTER TABLE PHYSICAL SE
(1)  154/       0 : =$3                  SCsDIR   EQU 3   ; DIRECTORY START PHYSICAL SECTOR N
(1)  155/       0 : =$16                 SCsDRE   EQU $16 ; DIRECTORY END PHYSICAL SECTOR NUM
(1)  156/       0 : =$17                 SCsBB    EQU $17 ; BOOT BLOCK PHYSICAL SECTOR NUMBER
(1)  157/       0 : =$18                 SCsDOS   EQU $18 ; OPERATING SYSTEM PHSYICAL SECTOR
(1)  158/       0 : =$80                 SCsSIZ   EQU 128 ; SECTOR SIZE IN BYTES
(1)  159/       0 : =$1A                 SCsTRK   EQU 26  ; NUMBER OF SECTORS/TRACK (SINGLE S
(1)  160/       0 : =$34                 SCsTKD   EQU 52  ; NUMBER OF SECTORS/CYLINDER (DOUBL
(1)  161/       0 : =$4                  SCsCLS   EQU 4   ; NUMBER OF SECTORS / CLUSTER
(1)  162/       0 :                     
(1)  163/       0 : =$7D0                SCsMAX EQU 2000 ; MAXIMUM NO. OF USABLE SECTORS (SI
(1)  164/       0 : =$FA4                SCsMXD EQU 4004 ; MAXIMUM NO. OF USABLE SECTORS <DO
(1)  165/       0 : =$20                 DFCLSs EQU 32   ; DEFAULT NO. OF CLUSTERS
(1)  166/       0 :                     
(1)  167/       0 :                     ;
(1)  168/       0 :                     ; DISK ID SECTOR OFFSETS
(1)  169/       0 :                     ;
(1)  170/       0 : =$0                  DIDsID  EQU  0   ; OFFSET TO DISK ID (8 BYTES)
(1)  171/       0 : =$8                  DIDsVN  EQU  8   ; OFFSET TO VERSION NUMBER (2 BYTES
(1)  172/       0 : =$A                  DIDsRN  EQU  10  ; OFFSET TO REVISION NUMBER (2 BYTE
(1)  173/       0 : =$C                  DIDsDT  EQU  12  ; OFFSET TO DATE (6 BYTES)
(1)  174/       0 : =$12                 DIDsNM  EQU  18  ; OFFSET TO USER NAME (20 BYTES)
(1)  175/       0 : =$26                 DIDsRB  EQU  38  ; OFFSET TO RIB ADDRS. (20 BYTES)
(1)  176/       0 :                     
(1)  177/       0 :                     ;
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm(mdoseq.inc) - Page 4 - 2026-01-23 11:21:24


(1)  178/       0 :                     ; DIRECTORY ENTRY OFFSET
(1)  179/       0 :                     ;
(1)  180/       0 : =$0                  DIRsNM  EQU 0   ; OFFSET TO NAME (8 BYTES)
(1)  181/       0 : =$8                  DIRsSX  EQU 8   ; OFFSET TO SUFFIX (2 BYTES)
(1)  182/       0 : =$A                  DIRsRB  EQU 10  ; OFFSET TO RIB ADDRESS (2 BYTES)
(1)  183/       0 : =$C                  DIRsAT  EQU 12  ; OFFSET OF ATTRIBUTES (2 BYTES)
(1)  184/       0 : =$E                  DIRsNU  EQU 14  ; OFFSET TO NOT USED AREA (2 BYTES)
(1)  185/       0 :                     
(1)  186/       0 :                     ;
(1)  187/       0 :                     ; RIB BINARY FILE OFFSET
(1)  188/       0 :                     ;
(1)  189/       0 : =$75                 RIBsLB  EQU 117 ; NUMBER OF BYTES IN LAST SECTOR
(1)  190/       0 : =$76                 RIBsSL  EQU 118 ; NUMBER OF SECTORS TO LOAD
(1)  191/       0 : =$78                 RIBsLA  EQU 120 ; MEMORY LOAD ADDRESS
(1)  192/       0 : =$7A                 RIBsSA  EQU 122 ; START EXECUTION ADDRESS
(1)  193/       0 :                     
(1)  194/       0 :                     ;
(1)  195/       0 :                     ; UNIFIED I/O CONTROL BLOCK OFFSETS
(1)  196/       0 :                     ;
(1)  197/       0 : =$0                  IOCSTA  EQU 0  ; ERROR STATUS
(1)  198/       0 : =$1                  IOCDTT  EQU 1  ; DATA TRANSFER TYPE
(1)  199/       0 : =$2                  IOCDBP  EQU 2  ; DATA BUFFER POINTER
(1)  200/       0 : =$4                  IOCDBS  EQU 4  ; DATA BUFFER START ADDRESS
(1)  201/       0 : =$6                  JOCDBE  EQU 6  ; DATA BUFFER END ADDRESS
(1)  202/       0 : =$8                  IOCGDW  EQU 8  ; GENERIC DEVICE TYPE/CDB ADDRESS
(1)  203/       0 : =$A                  IOCLUN  EQU 10 ; LOGICAL UNIT NUMBER
(1)  204/       0 : =$B                  IOCNAM  EQU 11 ; FILE NAME
(1)  205/       0 : =$B                  IOCMLS  EQU 11 ; MAXIMUM REFERENCED LSN
(1)  206/       0 : =$D                  IOCSDW  EQU 13 ; CURRENT SEGMENT DESCRIPTOR WORD
(1)  207/       0 : =$F                  IOCSLS  EQU 15 ; 1ST LOGICAL SECTOR OF CURRENT SEG
(1)  208/       0 : =$11                 IOCLSN  EQU 17 ; CURRENT LOGICAL SECTOR NUMBER
(1)  209/       0 : =$13                 IOCSUF  EQU 19 ; FILE NAME SUFFIX
(1)  210/       0 : =$13                 IOCEOF  EQU 19 ; LOGICAL END OF FIl.E
(1)  211/       0 : =$15                 IOCRIB  EQU 21 ; PHYSICAL DISK ADDRESS OF R. I.B.
(1)  212/       0 : =$17                 IOCFDF  EQU 23 ; FILE DESCRIPTOR FLAGS
(1)  213/       0 : =$1B                 IOCDEN  EQU 27 ; DIRECTORY ENTRY NUMBER
(1)  214/       0 : =$1D                 IOCSBP  EQU 29 ; SECTOR BUFFER POINTER/INITIAL SIZ
(1)  215/       0 : =$1F                 IOCSBS  EQU 31 ; SECTOR BUFFER START ADDRESS
(1)  216/       0 : =$21                 IOCSBE  EQU 33 ; SECTOR BUFFER END ADDRESS
(1)  217/       0 : =$23                 IOCSBI  EQU 35 ; SECTOR BUFFER INTERNAL PTR
(1)  218/       0 : =$25                 IOCBLN  EQU IOCSBI+2-IOCSTA ; IOCB LENGTH
(1)  219/       0 :                     
(1)  220/       0 :                     ;
(1)  221/       0 :                     ; UNIFIED I/O ERROR STATUS
(1)  222/       0 :                     ;
(1)  223/       0 : =$0                  IsNOER  EQU  $0 ; NO ERRORS, NORMAL RETURN
(1)  224/       0 : =$1                  IsNODV  EQU  $1 ; NO SUCH DEVICE
(1)  225/       0 : =$2                  IsRES   EQU  $2 ; DEVICE RESERVED ALREADY
(1)  226/       0 : =$3                  IsNORV  EQU  $3 ; DEVICE NOT RESERVED
(1)  227/       0 : =$4                  IsNRDY  EQU  $4 ; DEVICE NOT READY
(1)  228/       0 : =$5                  IsIVDV  EQU  $5 ; INVALID DEVICE
(1)  229/       0 : =$6                  IsDUPE  EQU  $6 ; DUPLICATE FILE NAME
(1)  230/       0 : =$7                  IsNONM  EQU  $7 ; FILE NAME NOT FOUND
(1)  231/       0 : =$8                  IsCLOS  EQU  $8 ; INVALID OPEN/CLOSED FLAG
(1)  232/       0 : =$9                  IsEOF   EQU  $9 ; END OF FILE
(1)  233/       0 : =$A                  IsFTYP  EQU  $A ; INVALID FILE TYPE
(1)  234/       0 : =$B                  IsDTYP  EQU  $B ; INVALID DATA TRANSFER TVPE
(1)  235/       0 : =$C                  IsEOM   EQU  $C ; END OF MEDIA
(1)  236/       0 : =$D                  IsBUFQ  EQU  $D ; BUFFER OVERFLOW
(1)  237/       0 : =$E                  IsCKSM  EQU  $E ; CHECKSUM ERROR
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm(mdoseq.inc) - Page 5 - 2026-01-23 11:21:24


(1)  238/       0 : =$F                  IsWRIT  EQU  $F ; FILE IS WRITE PROTECTED
(1)  239/       0 : =$10                 IsDELT  EQU $10 ; FILE IS DELETE PROTECTED
(1)  240/       0 : =$11                 IsRANG  EQU $11 ; LOQICAL SECTOR NUMBER OUT OF RANG
(1)  241/       0 : =$12                 IsFSPC  EQU $12 ; NO DISK FILE SPACE AVAILABLE
(1)  242/       0 : =$13                 IsDSPC  EQU $13 ; NO DIRECTORY SPACE AVAILABL.E
(1)  243/       0 : =$14                 IsSSPC  EQU $14 ; NO SEGMENT DESCRIPTOR SPACE AVAIL
(1)  244/       0 : =$15                 IsIDEN  EQU $15 ; INVALID DIR. ENTRY NO.
(1)  245/       0 : =$16                 IsRIB   EQU $16 ; INVALID RIB
(1)  246/       0 : =$17                 IsDEAL  EQU $17 ; CAN'T DEALLOCATE ALL SPACE
(1)  247/       0 : =$18                 IsRECL  EQU $18 ; BINARY RECORD LENGTH TOO LRGE
(1)  248/       0 : =$19                 IsSECB  EQU $19 ; SECTOR BUFFER SIZE ERROR
(1)  249/       0 :                     
(1)  250/       0 :                     ;
(1)  251/       0 :                     ; MDOS INTERNAL VARIABLE AND LOCATION EQUATES
(1)  252/       0 :                     ;
(1)  253/       0 : =$100                MDOSs   EQU $100  ; START OF MDOS ASECT
(1)  254/       0 : =$50                 CBUFLs  EQU  80   ; COMMAND BUFFER LENGTH
(1)  255/       0 : =$AE                 CBUFFs  EQU  MDOSs-CBUFLs-2 ; COMMAND BUFFER LOCATION
(1)  256/       0 : =$FE                 CBUFPs  EQU  CBUFFs+CBUFLs  ; COMMAND BUFFER SCAN POINTER
(1)  257/       0 : =$100                VERSss  EQU  MDOSs    ; VERSION#
(1)  258/       0 : =$102                REVSss  EQU  VERSss+2 ; REVISION#
(1)  259/       0 : =$104                KYIsSV  EQU  REVSss+2 ; SAVE AREA FOR KEYINs VECTOR
(1)  260/       0 : =$106                ENDOSs  EQU  KYIsSV+2 ; END OF MDOS
(1)  261/       0 : =$108                ENDUSs  EQU  ENDOSs+2 ; END OF USER PROGRAM AREA
(1)  262/       0 : =$10A                ENDSYs  EQU  ENDUSs+2 ; END OF SYSTEM (MDOS) RAM
(1)  263/       0 : =$10E                RIBBAs  EQU  ENDSYs+4 ; RIB BUFFER ADDRESS
(1)  264/       0 : =$110                ENDRVs  EQU  RIBBAs+2 ; END OF MDOS ROM VARIABLES
(1)  265/       0 : =$112                GDBAs   EQU  ENDRVs+2 ; GENERIC DEVICE TABLE ADDRESS
(1)  266/       0 :                     
(1)  267/       0 : =$114                SYERRs  EQU GDBAs+2  ; SYSTEM ERROR STATUS WORD
(1)  268/       0 : =$116                SWIsSV  EQU SYERRs+2 ; SWI VECTOR SAVE AREA
(1)  269/       0 : =$118                SWIsUV  EQU SWIsSV+2 ; SWI USER VECTOR
(1)  270/       0 : =$11A                IRGsUV  EQU SWIsUV+2 ; IRG USER VECTOR
(1)  271/       0 : =$11C                IRGsSV  EQU IRGsUV+2 ; IRG VECTOR SAVE AREA
(1)  272/       0 : =$11E                CHFLGs  EQU IRGsSV+2 ; CHAIN FUNCTION FLAG WORD
(1)  273/       0 : =$120                SYIOCB  EQU CHFLGs+2 ; SYSTEM CONSOLE IOCB
(1)  274/       0 : =$145                SYPOCB  EQU SYIOCB+IOCBLN ; SYSTEM PRINTER IOCB
(1)  275/       0 : =$16A                SYEOCB  EQU SYPOCB+IOCBLN ; ERR MSG FILE
(1)  276/       0 :                     
(1)  277/       0 :                     ;
(1)  278/       0 :                     ; LOGICAL UNIT NUMBER - BIT DEF
(1)  279/       0 :                     ;
(1)  280/       0 : =$40                 LUsRES EQU %01000000 ; IOCB RESERVED FLAG
(1)  281/       0 :                     
(1)  282/       0 :                     ;
(1)  283/       0 :                     ; IOCDTT BIT DEFINITIONS
(1)  284/       0 :                     ;
(1)  285/       0 : =$0                  DTsOPP EQU %00000000 ; OPEN UPDATE/INPUT
(1)  286/       0 : =$1                  DTsOPI EQU %00000001 ; OPEN INPUT MODE
(1)  287/       0 : =$2                  DTsOPO EQU %00000010 ; OPEN OUTPUT MODE
(1)  288/       0 : =$3                  DTsOPU EQU %00000011 ; OPEN UPDATE MODE
(1)  289/       0 : =$4                  DTsNFF EQU %00000100 ; NON-FILE FORMAT I/O FLAG
(1)  290/       0 : =$8                  DTsTRU EQU %00001000 ; TRUNCATE FLAG
(1)  291/       0 : =$10                 DTsCLS EQU %00010000 ; FILE OPEN/CLOSE FLAG
(1)  292/       0 : =$20                 DTsSIO EQU %00100000 ; SECTOR I/O FLAG
(1)  293/       0 : =$40                 DTsOUT EQU %01000000 ; OUTPUT TRANSFER TYPE
(1)  294/       0 : =$80                 DTsINP EQU %10000000 ; INPUT TRANSFER TYPE
(1)  295/       0 :                     
(1)  296/       0 :                     ;
(1)  297/       0 :                     ; IOCFDF BIT DEFINITIONS
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm(mdoseq.inc) - Page 6 - 2026-01-23 11:21:24


(1)  298/       0 :                     ;
(1)  299/       0 : =$0                  FDsFMU EQU %00000000 ; USER DEFINED FORMAT (SECTOR I/O)
(1)  300/       0 : =$1                  FDsFMD EQU %00000001 ; DEFAULT OBJECT REC'D FORMAT
(1)  301/       0 : =$2                  FDsFML EQU %00000010 ; BINARY LOAD FORMAT
(1)  302/       0 : =$3                  FDsFMB EQU %00000011 ; BINARY RECORD FORMAT
(1)  303/       0 : =$5                  FDsFMA EQU %00000101 ; ASCII RECORD FORMAT
(1)  304/       0 : =$7                  FDsFMC EQU %00000111 ; ASCI-CONVERTED-BINARY REC'O FORM
(1)  305/       0 : =$8                  FDsCMP EQU %00001000 ; SPACE COMPRESSION FLAG
(1)  306/       0 : =$10                 FDsCON EQU %00010000 ; CONTIGUOUS ALLOCATION FLAG
(1)  307/       0 : =$20                 FDsSYS EQU %00100000 ; SYSTEM FILE ATTRIBUTE
(1)  308/       0 : =$40                 FDsDEL EQU %01000000 ; DELETE PROTECTION ATTRIBUTE
(1)  309/       0 : =$80                 FDsWRT EQU %10000000 ; WRITE PROTECTION ATTRIBUTE
(1)  310/       0 :                     
(1)  311/       0 :                     ;
(1)  312/       0 :                     ; UNIFIED I/O CONTROL DESCRIPTION BLOCK OFFSETS
(1)  313/       0 :                     ;
(1)  314/       0 : =$0                  CDBIOC EQU  0 ; ADDRESS OF IOCB
(1)  315/       0 : =$2                  CDBSDA EQU  2 ; SOFTWARE DRIVER ADDRESS
(1)  316/       0 : =$4                  CDBHAD EQU  4 ; HARDWARE ADDRESS
(1)  317/       0 : =$6                  CDBDDF EQU  6 ; DEVICE DESCRIPTOR FLAGS
(1)  318/       0 : =$7                  CDBVDT EQU  7 ; VALID DATA TYPE
(1)  319/       0 : =$8                  CDBDDA EQU  8 ; DEVICE DEPENDENT AREA
(1)  320/       0 : =$A                  CDBWST EQU 10 ; WORKING STORAGE
(1)  321/       0 : =$C                  CDBLEN EQU CDBWST+2 ; CDB LENGTH
(1)  322/       0 :                     
(1)  323/       0 :                     ;
(1)  324/       0 :                     ; CDBDDF BIT DEFINITIONS
(1)  325/       0 :                     ;
(1)  326/       0 : =$1                  DDsFMC EQU $00000001 ; ASCII-CONVERTED-BINARY IS DEFAUL
(1)  327/       0 : =$2                  DDsLOG EQU %00000010 ; LOGICAL SECTOR I/O FLAG
(1)  328/       0 : =$4                  DDsCNS EQU %00000100 ; CONSOLE FLAG
(1)  329/       0 : =$8                  DDsRWD EQU %00001000 ; REWIND FLAG
(1)  330/       0 : =$10                 DDsOCF EQU %00010000 ; OPEN/CLOSE FLAG
(1)  331/       0 : =$20                 DDsINP EQU %00100000 ; INPUT DEVICE FLAG
(1)  332/       0 : =$40                 DDsOUT EQU %01000000 ; OUTPUT DEVICE FLAG
(1)  333/       0 : =$80                 DDsRES EQU %10000000 ; RESERVABLE DEVICE FLAG
(1)  334/       0 :                     
(1)  335/       0 :                     ;
(1)  336/       0 :                     ; CDBVDT BIT DEFINITIONS
(1)  337/       0 :                     ;
(1)  338/       0 : =$4                  VDsBIN EQU %00000100 ; BINARY OBJECT FLAG
(1)  339/       0 : =$8                  VDsGDB EQU %00001000 ; TEMP GDB POINTER FLAG
(1)  340/       0 : =$10                 VDsSDA EQU %00010000 ; TEMP SDA POINTER FLAG
(1)  341/       0 : =$80                 VDsNFF EQU %10000000 ; NON-FILE FORMAT FLAG
(1)  342/       0 :                     
(1)  343/       0 :                     ;
(1)  344/       0 :                     ; DEVICE DRIVER ENTRY OFFSET
(1)  345/       0 :                     ;
(1)  346/       0 : =$0                  DVsON   EQU 0   ; DEVICE ON OFFSET
(1)  347/       0 : =$3                  DVsOFF  EQU 3   ; DEVICE OFF OFFSET
(1)  348/       0 : =$6                  DVsINT  EQU 6   ; DEVICE INTIALIZATION OFFSET
(1)  349/       0 : =$9                  DVsTRM  EQU 9   ; DEVICE TERMINATION OFFSET
(1)  350/       0 : =$C                  DVsIO   EQU 12  ; DEVICE CHARACTER INPUT/OUTPUT OFF
(1)  351/       0 :                     
(1)  352/       0 :                     ;
(1)  353/       0 :                     ; DISK EROM EQUATES
(1)  354/       0 :                     ;
(1)  355/       0 : =$0                  CURDRV  EQU  0 ; CURRENT DRIVE NUMBER
(1)  356/       0 : =$1                  STRSCT  EQU  1 ; STARTING PHYSICAL SECTOR NUMBER
(1)  357/       0 : =$3                  NUMSCT  EQU  3 ; NUMBER OF SECTORS TO OPERATE UPON
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm(mdoseq.inc) - Page 7 - 2026-01-23 11:21:24


(1)  358/       0 : =$5                  LSCTLN  EQU  5 ; # OF BYTES TO READ FROM LAST SECT
(1)  359/       0 : =$6                  CURADR  EQU  6 ; MEMORY ADDRESS FOR DISK TRANSFER
(1)  360/       0 : =$8                  FDSTAT  EQU  8 ; DISK TRANSFER STATUS
(1)  361/       0 : =$B                  SCTCNT  EQU 11 ; SECTOR COUNT USED IN DETERMINING
(1)  362/       0 : =$D                  SIDES   EQU $D ; - ->SINGLEi + -> DOUBLE SIDED
(1)  363/       0 :                     
(1)  364/       0 :                     ;
(1)  365/       0 :                     ; EROM ENTRY POINTS
(1)  366/       0 :                     ;
(1)  367/       0 : =$E800               DSLOAD  EQU  $E800 ; BOOTSTRAP THE OPERATING SYSTEM
(1)  368/       0 : =$E822               FDINIT  EQU  $E822 ; INITIALIZE THE DISK'S PIA AND SSD
(1)  369/       0 : =$E853               CHKERR  EQU  $E853 ; CHECK AND PRINT ERROR FROM FDSTAT
(1)  370/       0 : =$E85A               PRNTER  EQU  $E85A ; PRINT ERROR FROM FDSTAT
(1)  371/       0 : =$E869               READSC  EQU  $E869 ; READ SECTOR(S)
(1)  372/       0 : =$E86D               READPS  EQU  $E86D ; READ PARTIAL SECTOR
(1)  373/       0 : =$E86F               RDCRC   EQU  $E86F ; READ AND CHECK FOR CRC
(1)  374/       0 : =$E872               RWTEST  EQU  $E872 ; WRITE/READ TEST
(1)  375/       0 : =$E875               RESTOR  EQU  $E875 ; MOVE HEAD TO TRACK 0
(1)  376/       0 : =$E878               SEEK    EQU  $E878 ; POSITION HEAD TO TRACK OF "STRSCT
(1)  377/       0 : =$E87B               WRTEST  EQU  $E87B ; WRITE TEST
(1)  378/       0 : =$E87E               WRDDAM  EQU  $E87E ; WRITE DELETED DATA MARK
(1)  379/       0 : =$E881               WRVERF  EQU  $E881 ; WRITE AND VERIFY CRC
(1)  380/       0 : =$E884               WRITSC  EQU  $E884 ; WRITE SECTDR(S)
(1)  381/       0 :                     
(1)  382/       0 :                     ;
(1)  383/       0 :                     ; EROM ERROR EQUATES
(1)  384/       0 :                     ;
(1)  385/       0 : ='1'                 ERsCRC  EQU  '1' ; DATA CRC ERROR
(1)  386/       0 : ='2'                 ERsWRT  EQU  '2' ; WRITE PROTECTED DISK
(1)  387/       0 : ='3'                 ERsRDY  EQU  '3' ; DISK NOT READY
(1)  388/       0 : ='4'                 ERsMRK  EQU  '4' ; DELETED DATA MARK ENCOUNTERED
(1)  389/       0 : ='5'                 ERsTIM  EQU  '5' ; TIMEOUT
(1)  390/       0 : ='6'                 ERsDAD  EQU  '6' ; INVALID DISK ADDRESS
(1)  391/       0 : ='7'                 ERsSEK  EQU  '7' ; SEEK ERROR
(1)  392/       0 : ='8'                 ERsDMA  EQU  '8' ; DATA ADDRESS MARK ERROR
(1)  393/       0 : ='9'                 ERsACR  EQU  '9' ; ADDRESS MARK CRC ERROR
(1)  394/       0 :                     
(1)  395/       0 :                     ;
(1)  396/       0 :                     ; MISCELLANEOUS EROM EQUATES
(1)  397/       0 :                     ;
(1)  398/       0 : =$5                  RETRYs  EQU  5   ; RETRY COUNT FOR DISK READ/WRITE E
(1)  399/       0 :                     
(1)  400/       0 :                     ;
(1)  401/       0 :                     ; LINE PRINTER EQUATES
(1)  402/       0 :                     ;
(1)  403/       0 : =$EBC0               LPINIT  EQU $EBC0 ; INIT PRINTER PIA
(1)  404/       0 : =$EBCC               LIST    EQU $EBCC ; PRINT CONTENTS OF 'A'
(1)  405/       0 : =$EBE4               LDATA   EQU $EBE4 ; PRINT STRING. CR/LF
(1)  406/       0 : =$EBF2               LDATA1  EQU $EBF2 ; PRINT STRING, NO CR/LF
(1)  407/       0 :                     
(1)  408/       0 :                     ;
(1)  409/       0 :                     ; EXBUG EQUATES FOR MDOS
(1)  410/       0 :                     ;
(1)  411/       0 :                     
(1)  412/       0 : =$F015               INCHNP EQU  $F015  ; INPUT CHARACTER (NO PARITY)
(1)  413/       0 : =$F018               OUTCH  EQU  $F018  ; OUTPUT ONE CHARACTER
(1)  414/       0 : =$F021               PCRLF  EQU  $F021  ; PRINT LF/CR
(1)  415/       0 : =$F024               PDATA  EQU  $F024  ; PRINT STRING
(1)  416/       0 : =$FCFD               SBITs  EQU  $FCFD  ; BIT 7 INDICATES IRG OCCURRED (IF
(1)  417/       0 : =$FF1F               BRKPTs EQU  $FF1F  ; MAID'S BREAKPOINT TABLE <8 FDB'S)
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm(mdoseq.inc) - Page 8 - 2026-01-23 11:21:24


(1)  418/       0 : =$FF4F               BKPINs EQU  $FF4F  ; EXBUG BREAKPOINTS IN MEMORY
(1)  419/       0 : =$FF53               AECHO  EQU  $FF53  ; INPUT CHARACTER ECHO FLAG (O=>ECH
(1)  420/       0 : =$FFF8               IRGsVC EQU  $FFF8  ; IRG VECTOR
(1)  421/       0 : =$FFFA               SWIsVC EQU  $FFFA  ; SWI VECTOR
(1)  422/       0 : =$FFFC               NMIsVC EQU  $FFFC  ; NMI VECTOR
(1)  423/       0 : =$FF8A               XSTAKs EQU  $FF8A  ; EXBUG STACK
(1)  424/       0 : =$F0F3               MAIDs  EQU  $F0F3  ; MAID ENTRY POINT
(1)  425/       0 : =$FF16               XREGsP EQU  $FF16  ; MAID P-REG.
(1)  426/       0 : =$FF18               XREGsX EQU  $FF18  ; MAID X-REG.
(1)  427/       0 : =$FF1A               XREGsA EQU  $FF1A  ; MAID A-REG.
(1)  428/       0 : =$FF1B               XREGsB EQU  $FF1B  ; MAID B-REG.
(1)  429/       0 : =$FF1C               XREGsC EQU  $FF1C  ; MAID C-REG.
(1)  430/       0 : =$FF1D               XREGsS EQU  $FF1D  ; MAID S-REG.
(1)  431/       0 : =$FF63               BRKPEs EQU  $FF63  ; END OF MAID BREAKPOINT TABLE
(1)  432/       0 : =$FCF4               CNACIs EQU  $FCF4  ; CONSOLE ACIA
(1)  433/       0 :                     
(1)  434/       0 :                     
(1)  435/       0 :                     
(1)  436/       0 :                     
(1)  437/       0 :                     
(1)  438/       0 :                     
(1)  439/       0 :                     
(1)  440/       0 :                     
(1)  441/       0 :                     
(1)  442/       0 :                     
(1)  443/       0 :                     
(1)  444/       0 :                     
(1)  445/       0 :                     
(1)  446/       0 :                     
(1)  447/       0 :                     
(1)  448/       0 :                     
(1)  449/       0 :                     
(1)  450/       0 :                     
(1)  451/       0 :                     
(1)  452/       0 :                     
(1)  453/       0 :                     
(1)  454/       0 :                     
       4/       0 :                     
       5/       0 : =$1                  STRSCTH EQU     $0001
       6/       0 : =$2                  STRSCTL EQU     $0002
       7/       0 : =$3                  NUMSCTH EQU     $0003
       8/       0 : =$4                  NUMSCTL EQU     $0004
       9/       0 : =$6                  CURADRH EQU     $0006
      10/       0 : =$9                  CWRDCNT EQU     $0009
      11/       0 : =$A                  SofTRK  EQU     $000A
      12/       0 : =$B                  SECTCNT EQU     $000B
      13/       0 : =$D                  STATSAV EQU     $000D
      14/       0 : =$E                  FUNCSAV EQU     $000E
      15/       0 : =$F                  NMIVECSAV EQU     $000F
      16/       0 : =$12                 M0012   EQU     $0012 ; $11 and $12 are current Track of Drive 0,1
      17/       0 : =$13                 TRACKSAV EQU    $0013
      18/       0 : =$14                 ADDRMRK EQU     $0014
      19/       0 : =$15                 DWRDCNT EQU     $0015
      20/       0 : =$16                 STACKSAV EQU     $0016
      21/       0 : =$18                 DRDCNT  EQU     $0018
      22/       0 : =$19                 CLKFREQ EQU     $0019
      23/       0 : =$20                 LDADDR  EQU     $0020
      24/       0 : =$22                 EXADDR     EQU     $0022
      25/       0 : =$24                 ONECON     EQU     $0024
      26/       0 :                     ; The PIA has A0 and A1 switched!
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 9 - 2026-01-23 11:21:24


      27/       0 :                     ; 00 with CRA2 Set is Peripheral Register A 
      28/       0 :                     ; 00 with CRA2 cleared is Data Direction Register A 
      29/       0 :                     ; 01 with CRB2 Set is Peripheral Register B 
      30/       0 :                     ; 01 with CRB2 cleared is Data Direction Register B 
      31/       0 :                     ; 02 is Control Register A
      32/       0 :                     ; 03 is Control Register B
      33/       0 : =$EC00               PIAREGA EQU     $EC00
      34/       0 : =$EC01               PIAREGB EQU     $EC01
      35/       0 : =$EC02               PIACTRL EQU     $EC02
      36/       0 : =$EC04               SSDA_0  EQU     $EC04
      37/       0 : =$EC05               SSDA_1  EQU     $EC05
      38/       0 : =$EC26               MEC26   EQU     $EC26
      39/       0 : =$EC27               MEC27   EQU     $EC27
      40/       0 : =$F000               PWRUP   EQU     $F000
      41/       0 :                     
      42/       0 : =$F018               XOUTCH  EQU     $F018
      43/       0 : =$F564               REENT2  EQU     $F564
      44/       0 : =$FCFC               PROM_0  EQU     $FCFC
      45/       0 :                     
      46/       0 :                     ;****************************************************
      47/       0 :                     ; Program's Code Areas
      48/       0 :                     ;****************************************************
      49/       0 :                     
      50/       0 :                     
      51/    E800 :                                     ORG     $E800
      52/    E800 :                     
      53/    E800 : 8E FF 8A            OSLOAD          LDS     #XSTAKs                  ; E800: 8E FF 8A  ; Set Stackpointer     
      54/    E803 : 4F                                  CLRA                             ; E803: 4F        ; |    
      55/    E804 : 97 00                               STAA    CURDRV                   ; E804: 97 00     ; Set Drive to zero   
      56/    E806 : 8D 48                               BSR     FDINIT2                  ; E806: 8D 48     ; Init PIA and SSDA
      57/    E808 : 8D 6B                               BSR     RESTOR                   ; E808: 8D 6B     ; 
      58/    E80A : 8D 47                               BSR     CHKERR                   ; E80A: 8D 47     ; 
      59/    E80C : CE 00 17                            LDX     #$0017                   ; E80C: CE 00 17  ; Start at Sector $17 (Bootblock) (0xB80)
      60/    E80F : DF 01                               STX     STRSCTH                  ; E80F: DF 01     ; |
      61/    E811 : CE 00 02                            LDX     #$0002                   ; E811: CE 00 02  ; Get 2 sectors
      62/    E814 : DF 03                               STX     NUMSCTH                  ; E814: DF 03     ; |
      63/    E816 : CE 00 20                            LDX     #LDADDR                  ; E816: CE 00 20  ; Load @ 0x20
      64/    E819 : DF 06                               STX     CURADRH                  ; E819: DF 06     ; |
      65/    E81B : 8D 4C                               BSR     READSC                   ; E81B: 8D 4C     ; Read the Sector
      66/    E81D : 8D 34                               BSR     CHKERR                   ; E81D: 8D 34     ; Check for Erroro
      67/    E81F : 7E 00 20                            JMP     LDADDR                   ; E81F: 7E 00 20  ; Execute loaded code....
      68/    E822 :                     ;------------------------------------------------
      69/    E822 :                     ;FDINIT
      70/    E822 : CE 00 00                            LDX     #$0000                   ; E822: CE 00 00  ; |
      71/    E825 : FF EC 02                            STX     PIACTRL                  ; E825: FF EC 02  ; clr both control Reg.
      72/    E828 : FF EC 00                            STX     PIAREGA                  ; E828: FF EC 00  ; Set A and B to Input
      73/    E82B : CE D0 DA                            LDX     #$D0DA                   ; E82B: CE D0 DA  ; 
      74/    E82E : FF EC 04                            STX     SSDA_0                   ; E82E: FF EC 04  ; 
      75/    E831 : CE 04 04                            LDX     #$0404                   ; E831: CE 04 04  ; |
      76/    E834 : FF EC 02                            STX     PIACTRL                  ; E834: FF EC 02  ; Set A and B to Output Reg.
      77/    E837 : CE 1B 02                            LDX     #$1B02                   ; E837: CE 1B 02  ; |
      78/    E83A : FF EC 00                            STX     PIAREGA                  ; E83A: FF EC 00  ; Set DS0, DS1, DIRQ, HLD, WG high
      79/    E83D : CE 00 00                            LDX     #$0000                   ; E83D: CE 00 00  ; |
      80/    E840 : FF EC 02                            STX     PIACTRL                  ; E840: FF EC 02  ; Set both to Data direction Reg.
      81/    E843 : CE 1F 0F                            LDX     #$1F0F                   ; E843: CE 1F 0F  ; |
      82/    E846 : FF EC 00                            STX     PIAREGA                  ; E846: FF EC 00  ; PA0-PA4, PB0-PB3 Output
      83/    E849 : CE 3C 3E                            LDX     #$3C3E                   ; E849: CE 3C 3E  ; |
      84/    E84C : FF EC 02                            STX     PIACTRL                  ; E84C: FF EC 02  ; Select both Output Reg., Set CA2 (STEP), Set CB2 (NMI Timer), IRQB (IRQ) Set by LH Transition of CB1 (IDX)
      85/    E84F : 39                  IE84F           RTS                              ; E84F: 39        ; Both Output Regsters Selected
      86/    E850 :                     ;------------------------------------------------
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 10 - 2026-01-23 11:21:24


      87/    E850 : BD EB A6            FDINIT2         JSR     FDINIT3                  ; E850: BD EB A6  ; 
      88/    E853 :                     ;------------------------------------------------
      89/    E853 :                     ;CHKERR
      90/    E853 : 24 FA                               BCC     IE84F                    ; E853: 24 FA     ; no carry - no error
      91/    E855 : 8D 03                               BSR     PRNTER                   ; E855: 8D 03     ; Print for ex.: 'E2 ' for Error 0x32
      92/    E857 : 7E F5 64                            JMP     REENT2                   ; E857: 7E F5 64  ; 
      93/    E85A :                     ;------------------------------------------------
      94/    E85A :                     ;
      95/    E85A :                     ;------------------------------------------------
      96/    E85A :                     ;PRNTER
      97/    E85A : 86 45                               LDAA    #$45                     ; E85A: 86 45      ; Load 'E'
      98/    E85C : 8D 08                               BSR     IE866                    ; E85C: 8D 08      ; 
      99/    E85E : 96 08                               LDAA    FDSTAT                   ; E85E: 96 08      ; 
     100/    E860 : 8D 04                               BSR     IE866                    ; E860: 8D 04      ; 
     101/    E862 : 86 20                               LDAA    #$20                     ; E862: 86 20      ; 
     102/    E864 : 8D 00                               BSR     IE866                    ; E864: 8D 00      ; 
     103/    E866 : 7E F0 18            IE866           JMP     XOUTCH                   ; E866: 7E F0 18   ; Print Accu A to Console
     104/    E869 :                     ;------------------------------------------------
     105/    E869 :                     ;READSC          LDAB    #$80                     ; E869: C6 80      ; 
     106/    E869 :                     ;                STAB    LSCTLN                   ; E86B: D7 05      ; 
     107/    E869 :                     ;READPS          CLRB                             ; E86D: 5F         ; 
     108/    E869 :                     ;                CPX     #MC640                   ; E86E: 8C C6 40   ; These CPX are just a method to deactivate the code after the LDAB
     109/    E869 :                     ;                CPX     #MC6C2                   ; E871: 8C C6 C2   ; These CPX are just a method to deactivate the code after the LDAB
     110/    E869 :                     ;                CPX     #MC608                   ; E874: 8C C6 08   ; These CPX are just a method to deactivate the code after the LDAB
     111/    E869 :                     ;                CPX     #MC610                   ; E877: 8C C6 10   ; These CPX are just a method to deactivate the code after the LDAB
     112/    E869 :                     ;                CPX     #MC682                   ; E87A: 8C C6 82   ; These CPX are just a method to deactivate the code after the LDAB
     113/    E869 :                     ;                CPX     #MC681                   ; E87D: 8C C6 81   ; These CPX are just a method to deactivate the code after the LDAB
     114/    E869 :                     ;                CPX     #MC6C0                   ; E880: 8C C6 C0   ; These CPX are just a method to deactivate the code after the LDAB
     115/    E869 :                     ;                CPX     #MC680                   ; E883: 8C C6 80   ; These CPX are just a method to deactivate the code after the LDAB
     116/    E869 :                     ;                CPX     #MC604                   ; E886: 8C C6 04   ; These CPX are just a method to deactivate the code after the LDAB
     117/    E869 :                     ;*************************************************
     118/    E869 :                     ; Meaning of the Bits in FUNCSAV:
     119/    E869 :                     ;
     120/    E869 :                     ; 7  6  5  4  3  2  1  0 
     121/    E869 :                     ; |  |  |  |  |  |  |  |-- 0: Write Deleted Address Mark (with bit 7 set)
     122/    E869 :                     ; |  |  |  |  |  |  |----- 1: test data from disk (with bit 7 set)
     123/    E869 :                     ; |  |  |  |  |  |-------- 2: measure the CPU Frequency via drive speed (these Bits are set alone)
     124/    E869 :                     ; |  |  |  |  |----------- 3: do a RESTOR (these Bits are set alone)
     125/    E869 :                     ; |  |  |  |-------------- 4: do a SEEK (these Bits are set alone)
     126/    E869 :                     ; |  |  |----------------- 5: not used
     127/    E869 :                     ; |  |-------------------- 6: do CRC Verify or read (can be set alone)
     128/    E869 :                     ; |----------------------- 7: write function (can be set alone)
     129/    E869 :                     ;
     130/    E869 :                     ;*************************************************
     131/    E869 :                     ;READSC
     132/    E869 : C6 80                               LDAB    #$80                     ; E869: C6 80    ; NO Bit set    ; causes the number of sectors contained in NUMSCT beginning with STRSCT from CURDRV to be read into memory starting at the address contained in CURADR
     133/    E86B : D7 05                               STAB    LSCTLN                   ; E86B: D7 05 
     134/    E86D :                     ;READPS
     135/    E86D : 5F                                  CLRB                             ; E86D: 5F       ; NO Bit set    ; similar to READSC with the exception that the last sector is only partially read according to the contents of LSCTLN
     136/    E86E : 8C                                  FCB     $8C
     137/    E86F :                     ;RDCRC 
     138/    E86F : C6 40                               LDAB    #$40                     ; E86F: C6 40    ; Bit 6 set     ; causes the number of sectors contained in NUMSCT beginning with STRSCT from CURDRV to be read to check their CRCs
     139/    E871 : 8C                                  FCB     $8C
     140/    E872 :                     ;RWTEST
     141/    E872 : C6 C2                               LDAB    #$C2                     ; E872: C6 C2    ; Bit 7,6,1 set ; same as WRTEST + readback and check CRC
     142/    E874 : 8C                                  FCB     $8C
     143/    E875 :                     ;RESTOR
     144/    E875 : C6 08                               LDAB    #$08                     ; E875: C6 08    ; Bit 3 set     ; causes the read/write head on CURDRV to be positioned to cylinder zero. The only parameter required is CURDRV.
     145/    E877 : 8C                                  FCB     $8C
     146/    E878 :                     ;SEEK  
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 11 - 2026-01-23 11:21:24


     147/    E878 : C6 10                               LDAB    #$10                     ; E878: C6 10    ; Bit 4 set     ; causes the read/write head of CURDRV to be positioned to the cylinder containing STRSCT
     148/    E87A : 8C                                  FCB     $8C
     149/    E87B :                     ;WRTEST
     150/    E87B : C6 82                               LDAB    #$82                     ; E87B: C6 82    ; Bit 7,1 set   ; causes the two bytes of data pointed to by the address in CURADR and the address+ 1 to be written to alternating bytes, respectively
     151/    E87D : 8C                                  FCB     $8C
     152/    E87E :                     ;WRDDAM
     153/    E87E : C6 81                               LDAB    #$81                     ; E87E: C6 81    ; Bit 7,0 set   ; causes a deleted data address mark to be written
     154/    E880 : 8C                                  FCB     $8C
     155/    E881 :                     ;WRVERF
     156/    E881 : C6 C0                               LDAB    #$C0                     ; E881: C6 C0    ; Bit 7,6 set   ; same as WRITSC + CRC Verify
     157/    E883 : 8C                                  FCB     $8C
     158/    E884 :                     ;WRITSC
     159/    E884 : C6 80                               LDAB    #$80                     ; E884: C6 80    ; Bit 7 set     ; causes NUMSCT sectors beginning with STRSCT of CURDRV to be written from memory beginning at CURADR
     160/    E886 : 8C                                  FCB     $8C
     161/    E887 : C6 04               CLOCK           LDAB    #$04                     ; E887: C6 04    ; Bit 2 set     ; calculate clock frequency of CPU
     162/    E889 :                     
     163/    E889 : 07                                  TPA                              ; E889: 07         ; Transfer Status Reg to A
     164/    E88A : 0F                                  SEI                              ; E88A: 0F        ; 
     165/    E88B : 97 0D                               STAA    STATSAV                  ; E88B: 97 0D     ; Save Status Reg.
     166/    E88D : D7 0E                               STAB    FUNCSAV                  ; E88D: D7 0E     ; Save Function
     167/    E88F : 86 30                               LDAA    #$30                     ; E88F: 86 30     ; 
     168/    E891 : 97 08                               STAA    FDSTAT                   ; E891: 97 08     ; Clear Errors ('0')
     169/    E893 : 9F 16                               STS     STACKSAV                 ; E893: 9F 16     ; Set Stackpointer
     170/    E895 : FE FF FC                            LDX     NMIsVC                   ; E895: FE FF FC  ; |
     171/    E898 : DF 0F                               STX     NMIVECSAV                ; E898: DF 0F     ; Save old NMIISR
     172/    E89A : CE E9 39                            LDX     #NMIISR                  ; E89A: CE E9 39  ; |
     173/    E89D : FF FF FC                            STX     NMIsVC                   ; E89D: FF FF FC  ; New NMIISR
     174/    E8A0 : CE 00 12                            LDX     #$0012                   ; E8A0: CE 00 12  ;  
     175/    E8A3 : 86 01                               LDAA    #$01                     ; E8A3: 86 01     ; 
     176/    E8A5 : 91 00                               CMPA    CURDRV                   ; E8A5: 91 00     ; is 0 at start
     177/    E8A7 : 25 12                               BCS     SERR3                    ; E8A7: 25 12     ; if CURDRV > 1 Error
     178/    E8A9 : 27 02                               BEQ     IE8AD                    ; E8A9: 27 02     ; if CURRDRV == 1 leave it @ $12
     179/    E8AB : 09                                  DEX                              ; E8AB: 09        ; else, down to $11
     180/    E8AC : 4C                                  INCA                             ; E8AC: 4C        ; A is 2 now
     181/    E8AD : B7 EC 00            IE8AD           STAA    PIAREGA                  ; E8AD: B7 EC 00  ; Write DS0, TG43, DIRQ, HLD low, Set DS1
     182/    E8B0 : A6 00                               LDAA    ,X                       ; E8B0: A6 00     ; X @ $11 for Drive 0 or $12 for Drive 1
     183/    E8B2 : 97 13                               STAA    TRACKSAV                 ; E8B2: 97 13     ; 
     184/    E8B4 : 86 40                               LDAA    #$40                     ; E8B4: 86 40     ; PA6 (RDY)
     185/    E8B6 : B5 EC 00                            BITA    PIAREGA                  ; E8B6: B5 EC 00  ; Check Drive Ready
     186/    E8B9 : 27 07                               BEQ     DRVRDY                   ; E8B9: 27 07     ; 
     187/    E8BB : C6 33               SERR3           LDAB    #$33                     ; E8BB: C6 33     ; Error '3' (DISK NOT READY)
     188/    E8BD :                     ;                CPX     #MC636                   ; E8BD: 8C C6 36  ; 
     189/    E8BD : 8C                                  FCB     $8C
     190/    E8BE : C6 36               SERR6           LDAB    #$36                                       ; Set Error '6' (INVALID DISK ADDRESS)
     191/    E8C0 : 20 7E                               BRA     SETERR                   ; E8C0: 20 7E     ; 
     192/    E8C2 :                     ;------------------------------------------------
     193/    E8C2 : C5 08               DRVRDY          BITB    #$08                     ; E8C2: C5 08     ; Get Bit3 from FUNCSAV (RESTOR)
     194/    E8C4 : 27 05                               BEQ     RESTORN                  ; E8C4: 27 05     ; Not RESTOR
     195/    E8C6 : 5F                                  CLRB                             ; E8C6: 5F        ; 
     196/    E8C7 : 86 03                               LDAA    #$03                     ; E8C7: 86 03     ; <------------------------------------ What is this??????
     197/    E8C9 : 20 3F                               BRA     RESTORY                  ; E8C9: 20 3F          
     198/    E8CB :                     ;------------------------------------------------
     199/    E8CB : C5 04               RESTORN         BITB    #$04                     ; E8CB: C5 04     ; Get Bit2 from FUNCSAV (CLOCK)
     200/    E8CD : 27 03                               BEQ     CLOCKN                   ; E8CD: 27 03     ; No Clock
     201/    E8CF : 7E EB 85                            JMP     CLKDMD                   ; E8CF: 7E EB 85  ; Calculate CPU Freq., goes to CLKDMD, ERRHNDLR and RST
     202/    E8D2 :                     ;------------------------------------------------
     203/    E8D2 : D6 02               CLOCKN          LDAB    STRSCTL                  ; E8D2: D6 02     ; normal code flow (no CLOCK, no RESTOR)
     204/    E8D4 : 96 01                               LDAA    STRSCTH                  ; E8D4: 96 01     ; Get Startsector
     205/    E8D6 : DB 04                               ADDB    NUMSCTL                  ; E8D6: DB 04     ; |
     206/    E8D8 : 99 03                               ADCA    NUMSCTH                  ; E8D8: 99 03     ; Add Number of sectors
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 12 - 2026-01-23 11:21:24


     207/    E8DA : 25 E2                               BCS     SERR6                    ; E8DA: 25 E2     ; Set Error '6': INVALID DISK ADDRESS
     208/    E8DC : C1 D3                               CMPB    #$D3                     ; E8DC: C1 D3     ; |
     209/    E8DE : 82 07                               SBCA    #$07                     ; E8DE: 82 07     ; 0x7D3 = 2003 (sector too big)
     210/    E8E0 : 24 DC                               BCC     SERR6                    ; E8E0: 24 DC     ; Set Error '6': INVALID DISK ADDRESS
     211/    E8E2 : 86 FF                               LDAA    #$FF                     ; E8E2: 86 FF     ; 
     212/    E8E4 : 97 0A                               STAA    SofTRK                   ; E8E4: 97 0A     ; 
     213/    E8E6 : 96 01                               LDAA    STRSCTH                  ; E8E6: 96 01     ; Startsector is usually at $17 at boot
     214/    E8E8 : D6 02                               LDAB    STRSCTL                  ; E8E8: D6 02     ; |
     215/    E8EA : 7C 00 0A            IE8EA           INC     SofTRK                   ; E8EA: 7C 00 0A  ; is now at 0
     216/    E8ED : C0 D0                               SUBB    #$D0                     ; E8ED: C0 D0     ; 0xd0 = 208 (8 tracks exactly)
     217/    E8EF : 82 00                               SBCA    #$00                     ; E8EF: 82 00     ; 
     218/    E8F1 : 24 F7                               BCC     IE8EA                    ; E8F1: 24 F7     ; $17-$D0 is negative, carry is set
     219/    E8F3 : CB D0                               ADDB    #$D0                     ; E8F3: CB D0     ; add $d0 again
     220/    E8F5 : 96 0A                               LDAA    SofTRK                   ; E8F5: 96 0A     ; is 0
     221/    E8F7 : 48                                  ASLA                             ; E8F7: 48        ; 
     222/    E8F8 : 48                                  ASLA                             ; E8F8: 48        ; 
     223/    E8F9 : 48                                  ASLA                             ; E8F9: 48        ; Sector * 8
     224/    E8FA : 4A                                  DECA                             ; E8FA: 4A        ; 
     225/    E8FB : 4C                  IE8FB           INCA                             ; E8FB: 4C        ; A is still 0
     226/    E8FC : C0 1A                               SUBB    #$1A                     ; E8FC: C0 1A     ; $1a = 26, is STRTSCT > 26
     227/    E8FE : 24 FB                               BCC     IE8FB                    ; E8FE: 24 FB     ; 
     228/    E900 : CB 1A                               ADDB    #$1A                     ; E900: CB 1A     ; $1a = 26, if no add it again
     229/    E902 : D7 0A                               STAB    SofTRK                   ; E902: D7 0A     ; store it in Sector of Track
     230/    E904 : DE 03                               LDX     NUMSCTH                  ; E904: DE 03     ; 
     231/    E906 : DF 0B                               STX     SECTCNT                  ; E906: DF 0B     ; 
     232/    E908 : D6 13                               LDAB    TRACKSAV                 ; E908: D6 13     ; 
     233/    E90A : 97 13               RESTORY         STAA    TRACKSAV                 ; E90A: 97 13     ; contains track (0 if RESTOR or 3)
     234/    E90C : 10                                  SBA                              ; E90C: 10        ; B cont. 0 if RESTOR
     235/    E90D : F6 EC 00                            LDAB    PIAREGA                  ; E90D: F6 EC 00  ; 
     236/    E910 : CA 08                               ORAB    #$08                     ; E910: CA 08     ; Isolate Bit 3 (DIRQ) | Check direction to STEP
     237/    E912 : 24 03                               BCC     IE917                    ; E912: 24 03     ;                      | Check direction to STEP
     238/    E914 : C4 F7                               ANDB    #$F7                     ; E914: C4 F7     ; Isolate Bit 3 (DIRQ) | Check direction to STEP
     239/    E916 : 40                                  NEGA                             ; E916: 40        ; 
     240/    E917 : C4 EF               IE917           ANDB    #$EF                     ; E917: C4 EF     ; Isolate PA4 (HLD)
     241/    E919 : 81 04                               CMPA    #$04                     ; E919: 81 04     ; Compare A with 4   <------------ WHY
     242/    E91B : 23 02                               BLS     IE91F                    ; E91B: 23 02     ; 
     243/    E91D : CA 10                               ORAB    #$10                     ; E91D: CA 10     ; Set Bit 4 (HLD)
     244/    E91F : F7 EC 00            IE91F           STAB    PIAREGA                  ; E91F: F7 EC 00  ; Write to Port
     245/    E922 : 4A                                  DECA                             ; E922: 4A        ; 
     246/    E923 : 2B 45                               BMI     ZE96A     ; -->          ; E923: 2B 45     ; 
     247/    E925 : 8D 1F                               BSR     STEP                     ; E925: 8D 1F     ; 
     248/    E927 : F6 EC 00                            LDAB    PIAREGA                  ; E927: F6 EC 00  ; 
     249/    E92A : 2A EB                               BPL     IE917                    ; E92A: 2A EB     ; Bit 7 clear? (TRK0)
     250/    E92C : 4D                                  TSTA                             ; E92C: 4D        ; 
     251/    E92D : 27 3B                               BEQ     ZE96A     ; -->          ; E92D: 27 3B     ; 
     252/    E92F : 96 0E                               LDAA    FUNCSAV                  ; E92F: 96 0E     ; 
     253/    E931 : 85 08                               BITA    #$08                     ; E931: 85 08     ; Get Bit3 from FUNCSAV (RESTOR)
     254/    E933 : 27 09                               BEQ     SERR7                    ; E933: 27 09     ; Function is NOT RESTOR, Set Error
     255/    E935 : 8D 25                               BSR     WAIT2                    ; E935: 8D 25     ; Wait
     256/    E937 : 20 58                               BRA     ERRHNDLR  ; -->          ; E937: 20 58     ; 
     257/    E939 :                     ;------------------------------------------------
     258/    E939 :                     ;
     259/    E939 :                     ;------------------------------------------------
     260/    E939 : 9E 16               NMIISR          LDS     STACKSAV                 ; E939: 9E 16     ; 
     261/    E93B : C6 35                               LDAB    #$35                     ; E93B: C6 35     ; Set Error '5' (TIMEOUT)
     262/    E93D :                     ;                CPX     #MC637                   ; E93D: 8C C6 37  ; 
     263/    E93D : 8C                                  FCB     $8C
     264/    E93E : C6 37               SERR7           LDAB    #$37                                       ; Set Error '7' (SEEK ERROR)
     265/    E940 : D7 08               SETERR          STAB    FDSTAT                   ; E940: D7 08     ; 
     266/    E942 : 8D 4D                               BSR     ERRHNDLR                 ; E942: 8D 4D     ; 
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 13 - 2026-01-23 11:21:24


     267/    E944 : 0D                                  SEC                              ; E944: 0D        ; 
     268/    E945 : 39                                  RTS                              ; E945: 39        ; 
     269/    E946 :                     ;------------------------------------------------
     270/    E946 :                     ;
     271/    E946 :                     ;------------------------------------------------
     272/    E946 : C6 34               STEP            LDAB    #$34                     ; E946: C6 34     ; Bit 5,4,2 set
     273/    E948 : F7 EC 02                            STAB    PIACTRL                  ; E948: F7 EC 02  ; CA2 low (STEP)
     274/    E94B : C6 3C                               LDAB    #$3C                     ; E94B: C6 3C     ; Bit 5,4,3,2 set
     275/    E94D : F7 EC 02                            STAB    PIACTRL                  ; E94D: F7 EC 02  ; CA2 high (STEP)
     276/    E950 : CE 00 FE                            LDX     #$00FE                   ; E950: CE 00 FE  ; 
     277/    E953 : D6 19               WAIT3           LDAB    CLKFREQ                  ; E953: D6 19     ; is 3 for 1MHz
     278/    E955 : 5A                  WAIT1           DECB                             ; E955: 5A        ; 
     279/    E956 : 26 FD                               BNE     WAIT1                    ; E956: 26 FD     ; 
     280/    E958 : 09                                  DEX                              ; E958: 09        ; 
     281/    E959 : 26 F8                               BNE     WAIT3                    ; E959: 26 F8     ; 
     282/    E95B : 39                                  RTS                              ; E95B: 39        ; 
     283/    E95C :                     ;------------------------------------------------
     284/    E95C : CE 01 87            WAIT2           LDX     #$0187                   ; E95C: CE 01 87  ; 
     285/    E95F : 20 F2                               BRA     WAIT3                    ; E95F: 20 F2     ; 
     286/    E961 :                     ;------------------------------------------------
     287/    E961 : 96 13               IE961           LDAA    TRACKSAV                 ; E961: 96 13     ; Function = RESTOR
     288/    E963 : 27 D9                               BEQ     SERR7                    ; E963: 27 D9     ; Is Track 0? If no Set Error '7' (SEEK ERROR)
     289/    E965 : 4F                                  CLRA                             ; E965: 4F        ; 
     290/    E966 : C6 56                               LDAB    #$56                     ; E966: C6 56     ; = 86 <------------------------------------ What is this??????
     291/    E968 : 20 A0                               BRA     RESTORY   ; -->          ; E968: 20 A0     ; 
     292/    E96A :                     ;------------------------------------------------
     293/    E96A :                     ; Comes from RESTORY
     294/    E96A :                     ;------------------------------------------------
     295/    E96A : CE 02 C0            ZE96A           LDX     #$02C0                   ; E96A: CE 02 C0  ; |
     296/    E96D : 8D E4                               BSR     WAIT3                    ; E96D: 8D E4     ; Wait
     297/    E96F : 96 0E                               LDAA    FUNCSAV                  ; E96F: 96 0E     ; What was the function?
     298/    E971 : 85 08                               BITA    #$08                     ; E971: 85 08     ; Is Function = RESTOR ?
     299/    E973 : 26 EC                               BNE     IE961                    ; E973: 26 EC     ; if yes, branch
     300/    E975 : 85 10                               BITA    #$10                     ; E975: 85 10     ; Is FUNCTION SEEK?
     301/    E977 : 26 18                               BNE     ERRHNDLR                 ; E977: 26 18     ; If yes - Done
     302/    E979 : C6 6F                               LDAB    #$6F                     ; E979: C6 6F     ; Write Sync data address mark
     303/    E97B : 46                                  RORA                             ; E97B: 46        ; Get Bit 0 into carry
     304/    E97C : 24 02                               BCC     IE980                    ; E97C: 24 02     ; Is Bit 0 set?
     305/    E97E : C6 6A                               LDAB    #$6A                     ; E97E: C6 6A     ; yes, write DELETED DATA MARK (WRDDAM)
     306/    E980 : D7 14               IE980           STAB    ADDRMRK                  ; E980: D7 14     ; 
     307/    E982 : 20 4F                               BRA     NXTSEC                   ; E982: 20 4F     ; next sector
     308/    E984 :                     ;------------------------------------------------
     309/    E984 :                     ; Comes from NXTSEC
     310/    E984 :                     ;------------------------------------------------
     311/    E984 : 96 0E               SECRDDONE       LDAA    FUNCSAV                  ; E984: 96 0E     ; Get Function
     312/    E986 : 2A 09                               BPL     ERRHNDLR                 ; E986: 2A 09     ; Bit 7 not Set - done (READPS, RDCRC, RESTOR, SEEK, CLOCK)
     313/    E988 : 84 40                               ANDA    #$40                     ; E988: 84 40     ; Isolate Bit 6
     314/    E98A : 97 0E                               STAA    FUNCSAV                  ; E98A: 97 0E     ;  
     315/    E98C : 27 03                               BEQ     ERRHNDLR                 ; E98C: 27 03     ; Bit 6 NOT set - done (READSC, WRTEST, WRDDAM, WRITSC)
     316/    E98E : 7E E8 D2                            JMP     CLOCKN                   ; E98E: 7E E8 D2  ; Bit 6 Set (normal codeflow) (RWTEST, WRVERF)
     317/    E991 :                     ;------------------------------------------------
     318/    E991 :                     ;
     319/    E991 :                     ;------------------------------------------------
     320/    E991 : CE 03 3C            ERRHNDLR        LDX     #$033C                   ; E991: CE 03 3C  ; |
     321/    E994 : FF EC 01                            STX     PIAREGB                  ; E994: FF EC 01  ; Set PB0,1 (RESET and WG) and Select A Output Reg., Set CA2 (STEP)
     322/    E997 : DE 0F                               LDX     NMIVECSAV                ; E997: DE 0F     ; |
     323/    E999 : FF FF FC                            STX     NMIsVC                   ; E999: FF FF FC  ; Restore old NMIISR
     324/    E99C : 96 13                               LDAA    TRACKSAV                 ; E99C: 96 13     ; 
     325/    E99E : D6 00                               LDAB    CURDRV                   ; E99E: D6 00     ; 
     326/    E9A0 : 27 03                               BEQ     IE9A5                    ; E9A0: 27 03     ; 
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 14 - 2026-01-23 11:21:24


     327/    E9A2 : 97 12                               STAA    M0012                    ; E9A2: 97 12     ; 
     328/    E9A4 :                     ;                CPX     #$9711                   ; E9A4: 8C 97 11  ; 
     329/    E9A4 : 8C                                  FCB     $8C
     330/    E9A5 : 97 11               IE9A5           STAA    $11                                       ;
     331/    E9A7 : 96 0D                               LDAA    STATSAV                  ; E9A7: 96 0D     ; 
     332/    E9A9 : 06                                  TAP                              ; E9A9: 06        ; Transfer A to Status Register
     333/    E9AA : 0C                                  CLC                              ; E9AA: 0C        ; 
     334/    E9AB : 39                                  RTS                              ; E9AB: 39        ; 
     335/    E9AC :                     ;------------------------------------------------
     336/    E9AC :                     ;
     337/    E9AC :                     ;------------------------------------------------
     338/    E9AC : CE D0 D8            READINIT        LDX     #$D0D8                   ; E9AC: CE D0 D8  ; Select CR2 and Inhibit SM, 2-Byte RDA, 8-Bit Word
     339/    E9AF : FF EC 04                            STX     SSDA_0                   ; E9AF: FF EC 04  ; |
     340/    E9B2 : CE EC 00                            LDX     #PIAREGA                 ; E9B2: CE EC 00  ; 
     341/    E9B5 : 86 50                               LDAA    #$50                     ; E9B5: 86 50     ; 
     342/    E9B7 : A7 04                               STAA    $04,X                    ; E9B7: A7 04     ; Write $50 to SSDA_0 (Enable Read)
     343/    E9B9 : 86 07                               LDAA    #$07                     ; E9B9: 86 07     ; 
     344/    E9BB : A7 01                               STAA    $01,X                    ; E9BB: A7 01     ; Write 7 to PIAREGB (Set to Read, Reset active., WG inact.)
     345/    E9BD : 6A 01                               DEC     $01,X                    ; E9BD: 6A 01     ; Reset inact.
     346/    E9BF : 08                                  INX                              ; E9BF: 08        ; 
     347/    E9C0 : 09                                  DEX                              ; E9C0: 09        ; 
     348/    E9C1 : 86 40                               LDAA    #$40                     ; E9C1: 86 40     ; Write $40 to SSDA_0 (Enable Sync, Select CR2)
     349/    E9C3 : A7 04                               STAA    $04,X                    ; E9C3: A7 04     ; 
     350/    E9C5 : 86 98                               LDAA    #$98                     ; E9C5: 86 98     ; Write $98 to SSDA_1 (Enable SM Output)
     351/    E9C7 : A7 05                               STAA    $05,X                    ; E9C7: A7 05     ; 
     352/    E9C9 : 39                                  RTS                              ; E9C9: 39        ; 
     353/    E9CA :                     ;------------------------------------------------
     354/    E9CA :                     ; NXTSEC:
     355/    E9CA :                     ; if sector >= 27 - steps to next Track,
     356/    E9CA :                     ; updates SECTCNT, SofTRK, CWRDCNT, DWRDCNT
     357/    E9CA :                     ;------------------------------------------------
     358/    E9CA : 97 0A               INCTRK          STAA    SofTRK                   ; E9CA: 97 0A     ; store new Sector of Track
     359/    E9CC : BD E9 46                            JSR     STEP                     ; E9CC: BD E9 46  ; move to next Track (X < 0)
     360/    E9CF : 8D 8B                               BSR     WAIT2                    ; E9CF: 8D 8B     ; wait some more (X < 0)
     361/    E9D1 : 6C 13                               INC     $13,X                    ; E9D1: 6C 13     ; increment TRACKSAV
     362/    E9D3 : 7C 00 0A            NXTSEC          INC     SofTRK                   ; E9D3: 7C 00 0A  ; increment Sector of Track
     363/    E9D6 : 96 0A                               LDAA    SofTRK                   ; E9D6: 96 0A     ; Load it to A
     364/    E9D8 : DE 0B                               LDX     SECTCNT                  ; E9D8: DE 0B     ; Load Sector count
     365/    E9DA : 27 A8                               BEQ     SECRDDONE   ; -->        ; E9DA: 27 A8     ; done?
     366/    E9DC : 80 1B                               SUBA    #$1B                     ; E9DC: 80 1B     ; Sector == 27?
     367/    E9DE : 24 EA                               BCC     INCTRK                   ; E9DE: 24 EA     ; increase Track
     368/    E9E0 : 86 05                               LDAA    #$05                     ; E9E0: 86 05     ; 
     369/    E9E2 : 97 18                               STAA    DRDCNT                   ; E9E2: 97 18     ; Data Read Counter
     370/    E9E4 : 09                                  DEX                              ; E9E4: 09        ; decrement sectorcount
     371/    E9E5 : 86 40               START           LDAA    #$40                     ; E9E5: 86 40     ; One Sector is $40 words
     372/    E9E7 : DF 0B                               STX     SECTCNT                  ; E9E7: DF 0B     ; store updated sectorcount
     373/    E9E9 : 26 07                               BNE     IE9F2                    ; E9E9: 26 07     ; not done, jump
     374/    E9EB : 96 05                               LDAA    LSCTLN                   ; E9EB: 96 05     ; LAST SofTRK LENGTH (1-128)
     375/    E9ED : 8B 07                               ADDA    #$07                     ; E9ED: 8B 07     ; isolate Bit 0,1,2
     376/    E9EF : 44                                  LSRA                             ; E9EF: 44        ; convert to words
     377/    E9F0 : 84 FC                               ANDA    #$FC                     ; E9F0: 84 FC     ; isolate Bit 0,1
     378/    E9F2 : 97 15               IE9F2           STAA    DWRDCNT                  ; E9F2: 97 15     ; is $40 for every full sector
     379/    E9F4 : 40                                  NEGA                             ; E9F4: 40        ; 
     380/    E9F5 : D6 0E                               LDAB    FUNCSAV                  ; E9F5: D6 0E     ; 
     381/    E9F7 : 58                                  ASLB                             ; E9F7: 58        ; Check Bit 6 (RDCRC, RWTEST, WRVERF)
     382/    E9F8 : 2A 01                               BPL     NOCRC                    ; E9F8: 2A 01     ; if not set, jump
     383/    E9FA : 4F                                  CLRA                             ; E9FA: 4F        ; 
     384/    E9FB : 8B 40               NOCRC           ADDA    #$40                     ; E9FB: 8B 40     ; 
     385/    E9FD : 97 09                               STAA    CWRDCNT                  ; E9FD: 97 09     ; 
     386/    E9FF : BD EB 74                            JSR     RETRG                    ; E9FF: BD EB 74  ; Retrigger NMI Timer
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 15 - 2026-01-23 11:21:24


     387/    EA02 : 96 13                               LDAA    TRACKSAV                 ; EA02: 96 13     ; 
     388/    EA04 : CA 0C                               ORAB    #$0C                     ; EA04: CA 0C     ; In B is FUNCSAV<<1, isol. Bit 2,3 (RWTEST, WRTEST, CLOCK)
     389/    EA06 : 81 2B                               CMPA    #$2B                     ; EA06: 81 2B     ; check for Track > 43
     390/    EA08 : 23 02                               BLS     IEA0C                    ; EA08: 23 02     ; No
     391/    EA0A : C4 FB                               ANDB    #$FB                     ; EA0A: C4 FB     ; Clr Bit 2 (CLOCK, and TG43 on PA2)
     392/    EA0C : E7 00               IEA0C           STAB    ,X                       ; EA0C: E7 00     ; Set Port
     393/    EA0E : CE D2 70                            LDX     #$D270                   ; EA0E: CE D2 70  ; Inhibit: Sync,Tx,Rx,Select CR3 and 1 Sync Character,Internal Sync,Clear: TUF,CTS
     394/    EA11 : FF EC 04                            STX     SSDA_0                   ; EA11: FF EC 04  ; |
     395/    EA14 : CE D1 F5                            LDX     #$D1F5                   ; EA14: CE D1 F5  ; Select Sync Code Register and Set Sync Code to hex F5
     396/    EA17 : FF EC 04                            STX     SSDA_0                   ; EA17: FF EC 04  ; |
     397/    EA1A :                     ;*************************************************
     398/    EA1A :                     ; Looking for ID Addr. Mark, correct Track and Sector
     399/    EA1A :                     ;*************************************************
     400/    EA1A : 8D 90               IEA1A           BSR     READINIT                 ; EA1A: 8D 90     ; X is on PIAREGA (EC00), Toggle RESET
     401/    EA1C : A6 04               IEA1C           LDAA    $04,X                    ; EA1C: A6 04     ; Read SSDA Status Reg.
     402/    EA1E : 2A FC                               BPL     IEA1C                    ; EA1E: 2A FC     ; Wait for Data
     403/    EA20 : A6 05                               LDAA    $05,X                    ; EA20: A6 05     ; Read SSDA Data Reg
     404/    EA22 : 81 7E                               CMPA    #$7E                     ; EA22: 81 7E     ; ID address mark ?
     405/    EA24 : 26 F4                               BNE     IEA1A                    ; EA24: 26 F4     ; No ?, Try again.
     406/    EA26 : A6 04               IEA26           LDAA    $04,X                    ; EA26: A6 04     ; *********** Found Id Addr. Mark ***********
     407/    EA28 : 2A FC                               BPL     IEA26                    ; EA28: 2A FC     ; Wait for Data
     408/    EA2A : A6 05                               LDAA    $05,X                    ; EA2A: A6 05     ; Read SSDA Data Reg into A
     409/    EA2C : E6 05                               LDAB    $05,X                    ; EA2C: E6 05     ; Read SSDA Data Reg into B
     410/    EA2E : 91 13                               CMPA    TRACKSAV                 ; EA2E: 91 13     ; Compare with Track
     411/    EA30 : 26 E8                               BNE     IEA1A                    ; EA30: 26 E8     ; Try again
     412/    EA32 : A6 04               IEA32           LDAA    $04,X                    ; EA32: A6 04     ; We are on the right Track, Read SSDA Status Reg.
     413/    EA34 : 2A FC                               BPL     IEA32                    ; EA34: 2A FC     ; Wait for Data
     414/    EA36 : A6 05                               LDAA    $05,X                    ; EA36: A6 05     ; Read SSDA Data Reg into A
     415/    EA38 : E6 05                               LDAB    $05,X                    ; EA38: E6 05     ; Read SSDA Data Reg into B
     416/    EA3A : 91 0A                               CMPA    SofTRK                   ; EA3A: 91 0A     ; Compare with sector
     417/    EA3C : 26 DC                               BNE     IEA1A                    ; EA3C: 26 DC     ; Try again
     418/    EA3E : A6 04               IEA3E           LDAA    $04,X                    ; EA3E: A6 04     ; Found Sector, Read SSDA Status Reg.
     419/    EA40 : 2A FC                               BPL     IEA3E                    ; EA40: 2A FC     ; Wait for Data
     420/    EA42 : 6D 05                               TST     $05,X                    ; EA42: 6D 05     ; 
     421/    EA44 : 96 19                               LDAA    CLKFREQ                  ; EA44: 96 19     ; 
     422/    EA46 : 80 03               IEA46           SUBA    #$03                     ; EA46: 80 03     ; 
     423/    EA48 : 22 FC                               BHI     IEA46                    ; EA48: 22 FC     ; 
     424/    EA4A : A6 01                               LDAA    $01,X                    ; EA4A: A6 01     ; Read PIAREGB
     425/    EA4C : 2B 3B                               BMI     SERR9                    ; EA4C: 2B 3B     ; PB7 High ? (CRC-0) - ERROR
     426/    EA4E :                     ;*************************************************
     427/    EA4E :                     ; Found corr. Track and Sector, now look for Data Addr. Mark
     428/    EA4E :                     ;*************************************************
     429/    EA4E : A6 05                               LDAA    $05,X                    ; EA4E: A6 05     ; 
     430/    EA50 : 86 04                               LDAA    #$04                     ; EA50: 86 04     ; Try four times
     431/    EA52 : 6D 04               IEA52           TST     $04,X                    ; EA52: 6D 04     ; Read SSDA Status Reg.
     432/    EA54 : 2A FC                               BPL     IEA52                    ; EA54: 2A FC     ; Wait for Data
     433/    EA56 : A1 05                               CMPA    $05,X                    ; EA56: A1 05     ; Compare SSDA Data Reg to A (04)
     434/    EA58 : A1 05                               CMPA    $05,X                    ; EA58: A1 05     ; Compare SSDA Data Reg to A (04)
     435/    EA5A : 4A                                  DECA                             ; EA5A: 4A        ; |
     436/    EA5B : 26 F5                               BNE     IEA52                    ; EA5B: 26 F5     ; try again
     437/    EA5D : D6 0E                               LDAB    FUNCSAV                  ; EA5D: D6 0E     ; 
     438/    EA5F : 2B 7C                               BMI     WRITINIT   ; -->         ; EA5F: 2B 7C     ; Bit 7 set - Write Function
     439/    EA61 : D6 19                               LDAB    CLKFREQ                  ; EA61: D6 19     ; Waitloop
     440/    EA63 : 58                                  ASLB                             ; EA63: 58        ; |
     441/    EA64 : 08                  IEA64           INX                              ; EA64: 08        ; |
     442/    EA65 : 09                                  DEX                              ; EA65: 09        ; |
     443/    EA66 : 5A                                  DECB                             ; EA66: 5A        ; |
     444/    EA67 : 26 FB                               BNE     IEA64                    ; EA67: 26 FB     ; |
     445/    EA69 : C6 04                               LDAB    #$04                     ; EA69: C6 04     ; Try four times
     446/    EA6B : BD E9 AC            IEA6B           JSR     READINIT                 ; EA6B: BD E9 AC  ; Initialize SSDA for Read, Toggle RESET
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 16 - 2026-01-23 11:21:24


     447/    EA6E : DE 06                               LDX     CURADRH                  ; EA6E: DE 06     ; Load Start Address
     448/    EA70 : B6 EC 04            IEA70           LDAA    SSDA_0                   ; EA70: B6 EC 04  ; Read SSDA Status Reg.
     449/    EA73 : 2A FB                               BPL     IEA70                    ; EA73: 2A FB     ; Wait and Test RDA for 2 Bytes Ready
     450/    EA75 : B6 EC 05                            LDAA    SSDA_1                   ; EA75: B6 EC 05  ; Read Data
     451/    EA78 : 81 6F                               CMPA    #$6F                     ; EA78: 81 6F     ; Sync data address mark
     452/    EA7A : 27 21                               BEQ     READSECT  ; -->          ; EA7A: 27 21     ; ********** Found data address mark *************
     453/    EA7C : 81 6A                               CMPA    #$6A                     ; EA7C: 81 6A     ; Read DELETED DATA MARK (set Error '4')
     454/    EA7E : 27 18                               BEQ     SERR4                    ; EA7E: 27 18     ; |
     455/    EA80 : 5A                                  DECB                             ; EA80: 5A        ; |
     456/    EA81 : 26 E8                               BNE     IEA6B                    ; EA81: 26 E8     ; again
     457/    EA83 : C6 38                               LDAB    #$38                     ; EA83: C6 38     ; (Set Error '8') (DATA MARK ERROR)
     458/    EA85 :                     ;                CPX     #MC631                   ; EA85: 8C C6 31  ; 
     459/    EA85 : 8C                                  FCB     $8C
     460/    EA86 : C6 31               SERR1           LDAB    #$31                                       ; (Set Error '1') (DATA CRC ERROR)
     461/    EA88 :                     ;                CPX     #MC639                   ; EA88: 8C C6 39  ; 
     462/    EA88 : 8C                                  FCB     $8C
     463/    EA89 : C6 39               SERR9           LDAB    #$39                                        ; (Set Error '9') (ADDRESS MARK CRC ERROR)
     464/    EA8B : 7A 00 18                            DEC     DRDCNT                   ; EA8B: 7A 00 18  ; decrement counter (was 5)
     465/    EA8E : 27 0A                               BEQ     IEA9A                    ; EA8E: 27 0A     ; if 0, set error
     466/    EA90 : DE 0B                               LDX     SECTCNT                  ; EA90: DE 0B     ; if not, try again
     467/    EA92 : 7E E9 E5                            JMP     START      ; -->         ; EA92: 7E E9 E5  ; 
     468/    EA95 :                     ;------------------------------------------------
     469/    EA95 : C6 32               SERR2           LDAB    #$32                     ; EA95: C6 32     ; Set Error '2' (DISK WRITE PROTECTED)
     470/    EA97 :                     ;                CPX     #MC634                   ; EA97: 8C C6 34  ; 
     471/    EA97 : 8C                                  FCB     $8C
     472/    EA98 : C6 34               SERR4           LDAB    #$34                                        ; (Set Error '4') (READ DELETED DATA MARK)
     473/    EA9A : 7E E9 40            IEA9A           JMP     SETERR     ; -->         ; EA9A: 7E E9 40  ; 
     474/    EA9D :                     ;------------------------------------------------
     475/    EA9D : D6 0E               READSECT        LDAB    FUNCSAV                  ; EA9D: D6 0E     ; data address mark found
     476/    EA9F : 58                                  ASLB                             ; EA9F: 58        ; FUNCSAV<<1
     477/    EAA0 : 2B 19                               BMI     CRCONLY                  ; EAA0: 2B 19     ; Check for READCRC ($40, Bit 6)
     478/    EAA2 : D6 15                               LDAB    DWRDCNT                  ; EAA2: D6 15     ; Data Wordcount
     479/    EAA4 : B6 EC 04            IEAA4           LDAA    SSDA_0                   ; EAA4: B6 EC 04  ; Read SSDA Status Reg.
     480/    EAA7 : 2A FB                               BPL     IEAA4                    ; EAA7: 2A FB     ; Wait and Test RDA for 2 Bytes Ready
     481/    EAA9 : B6 EC 05                            LDAA    SSDA_1                   ; EAA9: B6 EC 05  ; Read Data to Buffer
     482/    EAAC : BC FC FC                            CPX     PROM_0                   ; EAAC: BC FC FC  ; X is on $20, in PROM_0 is zero *** This does nothing ! ***
     483/    EAAF : A7 00                               STAA    ,X                       ; EAAF: A7 00     ; |
     484/    EAB1 : B6 EC 05                            LDAA    SSDA_1                   ; EAB1: B6 EC 05  ; |
     485/    EAB4 : A7 01                               STAA    $01,X                    ; EAB4: A7 01     ; |
     486/    EAB6 : 08                                  INX                              ; EAB6: 08        ; |
     487/    EAB7 : 08                                  INX                              ; EAB7: 08        ; |
     488/    EAB8 : 5A                                  DECB                             ; EAB8: 5A        ; |
     489/    EAB9 : 26 E9                               BNE     IEAA4                    ; EAB9: 26 E9     ; 
     490/    EABB : D6 09               CRCONLY         LDAB    CWRDCNT                  ; EABB: D6 09     ; CRC Wordcount
     491/    EABD : B6 EC 04            READCRC         LDAA    SSDA_0                   ; EABD: B6 EC 04  ; Read SSDA Status Reg.
     492/    EAC0 : 2A FB                               BPL     READCRC                  ; EAC0: 2A FB     ; Wait and Test RDA for 2 Bytes Ready
     493/    EAC2 : 5A                                  DECB                             ; EAC2: 5A        ; dec. counter
     494/    EAC3 : 2B 08                               BMI     CRCOK                    ; EAC3: 2B 08     ; finished ?
     495/    EAC5 : B6 EC 05                            LDAA    SSDA_1                   ; EAC5: B6 EC 05  ; Read SSDA Data to A
     496/    EAC8 : B6 EC 05                            LDAA    SSDA_1                   ; EAC8: B6 EC 05  ; Read SSDA Data to A
     497/    EACB : 20 F0                               BRA     READCRC                  ; EACB: 20 F0     ; continue
     498/    EACD :                     
     499/    EACD : 96 19               CRCOK           LDAA    CLKFREQ                  ; EACD: 96 19     ; 
     500/    EACF : 80 03               IEACF           SUBA    #$03                     ; EACF: 80 03     ; 
     501/    EAD1 : 22 FC                               BHI     IEACF                    ; EAD1: 22 FC     ; 
     502/    EAD3 : B6 EC 01                            LDAA    PIAREGB                  ; EAD3: B6 EC 01  ; |
     503/    EAD6 : 2B AE                               BMI     SERR1                    ; EAD6: 2B AE     ; PB7 High ? (CRC-0) Error
     504/    EAD8 : DF 06                               STX     CURADRH                  ; EAD8: DF 06     ; CRC ok
     505/    EADA : 7E E9 D3                            JMP     NXTSEC     ; -->         ; EADA: 7E E9 D3  ; next sector
     506/    EADD :                     ;------------------------------------------------
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 17 - 2026-01-23 11:21:24


     507/    EADD :                     ;
     508/    EADD :                     ;------------------------------------------------
     509/    EADD : CE C0 DA            WRITINIT        LDX     #$C0DA                   ; EADD: CE C0 DA  ; 
     510/    EAE0 : FF EC 04                            STX     SSDA_0                   ; EAE0: FF EC 04  ; 
     511/    EAE3 : CE C1 AA                            LDX     #$C1AA                   ; EAE3: CE C1 AA  ; 
     512/    EAE6 : FF EC 04                            STX     SSDA_0                   ; EAE6: FF EC 04  ; 
     513/    EAE9 : CE C2 70                            LDX     #$C270                   ; EAE9: CE C2 70  ; 
     514/    EAEC : FF EC 04                            STX     SSDA_0                   ; EAEC: FF EC 04  ; 
     515/    EAEF : 7C EC 01                            INC     PIAREGB                  ; EAEF: 7C EC 01  ; 
     516/    EAF2 : 86 82                               LDAA    #$82                     ; EAF2: 86 82     ; Bit 1,7
     517/    EAF4 : B7 EC 04                            STAA    SSDA_0                   ; EAF4: B7 EC 04  ; WG off, PB7 is an Input 
     518/    EAF7 : 09                                  DEX                              ; EAF7: 09        ; 
     519/    EAF8 : B7 EC 01                            STAA    PIAREGB                  ; EAF8: B7 EC 01  ; 
     520/    EAFB : 86 10                               LDAA    #$10                     ; EAFB: 86 10     ; Bit 4
     521/    EAFD : B5 EC 01                            BITA    PIAREGB                  ; EAFD: B5 EC 01  ; Check Writeprot?
     522/    EB00 : 27 93                               BEQ     SERR2                    ; EB00: 27 93     ; If yes set Error
     523/    EB02 : 96 19                               LDAA    CLKFREQ                  ; EB02: 96 19     ; Waitloop
     524/    EB04 : 80 03                               SUBA    #$03                     ; EB04: 80 03     ; |
     525/    EB06 : 48                                  ASLA                             ; EB06: 48        ; |
     526/    EB07 : 4A                  IEB07           DECA                             ; EB07: 4A        ; |
     527/    EB08 : 2A FD                               BPL     IEB07                    ; EB08: 2A FD     ; |
     528/    EB0A : 7F EC 01                            CLR     PIAREGB                  ; EB0A: 7F EC 01  ; Clear all PB (Set to Write, Reset off, ShiftCRC off, WG on)
     529/    EB0D : 56                                  RORB                             ; EB0D: 56        ; 
     530/    EB0E : 24 01                               BCC     IEB11                    ; EB0E: 24 01     ; 
     531/    EB10 :                     ;                BITA    #$56                     ; EB10: 85 56     ; 
     532/    EB10 : 85                                  FCB     $85                
     533/    EB11 : 56                  IEB11           RORB                             ;                 
     534/    EB12 : CE 00 05                            LDX     #$0005                   ; EB12: CE 00 05  ; 
     535/    EB15 : BD E9 53                            JSR     WAIT3                    ; EB15: BD E9 53  ; 
     536/    EB18 : C6 40                               LDAB    #$40                     ; EB18: C6 40     ; 
     537/    EB1A : 96 14                               LDAA    ADDRMRK                  ; EB1A: 96 14     ; 
     538/    EB1C : CE 83 F5                            LDX     #$83F5                   ; EB1C: CE 83 F5  ; 
     539/    EB1F : FF EC 04                            STX     SSDA_0                   ; EB1F: FF EC 04  ; 
     540/    EB22 : DE 06                               LDX     CURADRH                  ; EB22: DE 06     ; 
     541/    EB24 : B7 EC 05                            STAA    SSDA_1                   ; EB24: B7 EC 05  ; 
     542/    EB27 : 7E EB 31                            JMP     WRITSEC                  ; EB27: 7E EB 31  ; 
     543/    EB2A :                     
     544/    EB2A : 86 40               IEB2A           LDAA    #$40                     ; EB2A: 86 40     ; 
     545/    EB2C : B5 EC 04            IEB2C           BITA    SSDA_0                   ; EB2C: B5 EC 04  ; Transmit Datareg. empty?
     546/    EB2F : 27 FB                               BEQ     IEB2C                    ; EB2F: 27 FB     ; If no, wait
     547/    EB31 : B6 FC FC            WRITSEC         LDAA    PROM_0                   ; EB31: B6 FC FC  ; in PROM_0 is zero
     548/    EB34 : 01                                  NOP                              ; EB34: 01        ;  
     549/    EB35 : A6 00                               LDAA    ,X                       ; EB35: A6 00     ; Load Data from RAM
     550/    EB37 : B7 EC 05                            STAA    SSDA_1                   ; EB37: B7 EC 05  ; Write to disk
     551/    EB3A : A6 01                               LDAA    $01,X                    ; EB3A: A6 01     ; Load next Byte
     552/    EB3C : B7 EC 05                            STAA    SSDA_1                   ; EB3C: B7 EC 05  ; Write to disk
     553/    EB3F : 25 02                               BCS     IEB43                    ; EB3F: 25 02     ; all done?
     554/    EB41 : 08                                  INX                              ; EB41: 08        ; if not, increase pointer
     555/    EB42 : 08                                  INX                              ; EB42: 08        ; |
     556/    EB43 : 5A                  IEB43           DECB                             ; EB43: 5A        ; decrease counter
     557/    EB44 : 26 E4                               BNE     IEB2A                    ; EB44: 26 E4     ; check if underflow, if not, continue from top
     558/    EB46 : DF 06                               STX     CURADRH                  ; EB46: DF 06     ; done, store current address
     559/    EB48 : CE EC 00                            LDX     #PIAREGA                 ; EB48: CE EC 00  ;  
     560/    EB4B : 86 40                               LDAA    #$40                     ; EB4B: 86 40     ;  
     561/    EB4D : A5 04               IEB4D           BITA    $04,X                    ; EB4D: A5 04     ; Check SSDA Status Reg.
     562/    EB4F : 27 FC                               BEQ     IEB4D                    ; EB4F: 27 FC     ; Wait for Data
     563/    EB51 : E7 05                               STAB    $05,X                    ; EB51: E7 05     ; Store B to Data Register
     564/    EB53 : A5 04               IEB53           BITA    $04,X                    ; EB53: A5 04     ; Check SSDA Status Reg.
     565/    EB55 : 27 FC                               BEQ     IEB53                    ; EB55: 27 FC     ; Wait for Data
     566/    EB57 : C6 08                               LDAB    #$08                     ; EB57: C6 08     ; 
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 18 - 2026-01-23 11:21:24


     567/    EB59 : E7 01                               STAB    $01,X                    ; EB59: E7 01     ; 
     568/    EB5B : E7 05                               STAB    $05,X                    ; EB5B: E7 05     ; 
     569/    EB5D : A5 04               IEB5D           BITA    $04,X                    ; EB5D: A5 04     ; 
     570/    EB5F : 27 FC                               BEQ     IEB5D                    ; EB5F: 27 FC     ; 
     571/    EB61 : C6 FF                               LDAB    #$FF                     ; EB61: C6 FF     ; 
     572/    EB63 : E7 05                               STAB    $05,X                    ; EB63: E7 05     ; 
     573/    EB65 : E7 05                               STAB    $05,X                    ; EB65: E7 05     ; 
     574/    EB67 : A5 04               IEB67           BITA    $04,X                    ; EB67: A5 04     ; 
     575/    EB69 : 27 FC                               BEQ     IEB67                    ; EB69: 27 FC     ; 
     576/    EB6B : 6F 01                               CLR     $01,X                    ; EB6B: 6F 01     ; 
     577/    EB6D : 6C 01                               INC     $01,X                    ; EB6D: 6C 01     ; 
     578/    EB6F : 6C 01                               INC     $01,X                    ; EB6F: 6C 01     ; 
     579/    EB71 : 7E E9 D3                            JMP     NXTSEC    ; -->          ; EB71: 7E E9 D3  ; next sector
     580/    EB74 :                     ;------------------------------------------------
     581/    EB74 : CE EC 00            RETRG           LDX     #PIAREGA                 ; EB74: CE EC 00  ; 
     582/    EB77 : 86 36                               LDAA    #$36                     ; EB77: 86 36     ; |
     583/    EB79 : A7 03                               STAA    $03,X                    ; EB79: A7 03     ; $36 -> PIACTRLB (CB2 Low - Trigger NMI Timer, IRQB Flag set by HL on CB1 - IDX, Select Output Reg. B)
     584/    EB7B : 86 3E                               LDAA    #$3E                     ; EB7B: 86 3E     ; |
     585/    EB7D : A7 03                               STAA    $03,X                    ; EB7D: A7 03     ; $3E -> PIACTRLB (CB2 high)
     586/    EB7F : E6 00                               LDAB    ,X                       ; EB7F: E6 00     ; Get Port A
     587/    EB81 : 4A                                  DECA                             ; EB81: 4A        ; 
     588/    EB82 : A7 02                               STAA    $02,X                    ; EB82: A7 02     ; $3D -> PIACTRLA (En. IRQA interrupt by CA1 - NMI Timer, Sel. Output Reg. A, CA2 high - STEP)
     589/    EB84 : 39                                  RTS                              ; EB84: 39        ; 
     590/    EB85 :                     ;------------------------------------------------
     591/    EB85 : 8D ED               CLKDMD          BSR     RETRG                    ; EB85: 8D ED     ; Retrigger NMI Timer
     592/    EB87 : E6 01                               LDAB    $01,X                    ; EB87: E6 01     ; PIAREGB Clear Interrupt Flag
     593/    EB89 : 4F                                  CLRA                             ; EB89: 4F        ;  
     594/    EB8A : E6 03               IEB8A           LDAB    $03,X                    ; EB8A: E6 03     ; PIACTRLB
     595/    EB8C : 2A FC                               BPL     IEB8A                    ; EB8C: 2A FC     ; Wait for IRQB on CB1 (IDX)
     596/    EB8E : E6 01                               LDAB    $01,X                    ; EB8E: E6 01     ; PIAREGB Clear Interrupt Flag
     597/    EB90 : 5F                  CLRTOP          CLRB                             ; EB90: 5F        ;  
     598/    EB91 : 5A                  IEB91           DECB                             ; EB91: 5A        ; Wait
     599/    EB92 : 26 FD                               BNE     IEB91                    ; EB92: 26 FD     ; |
     600/    EB94 : 4C                                  INCA                             ; EB94: 4C        ; In A is the ammount of 256 ticks
     601/    EB95 : 6D 03                               TST     $03,X                    ; EB95: 6D 03     ; PIACTRLB
     602/    EB97 : 2A F7                               BPL     CLRTOP                   ; EB97: 2A F7     ; Wait for IRQB on CB1 (IDX) 166ms later
     603/    EB99 : 5C                                  INCB                             ; EB99: 5C        ; B is 1 now
     604/    EB9A : 80 4B                               SUBA    #$4B                     ; EB9A: 80 4B     ;  
     605/    EB9C : 5C                  IEB9C           INCB                             ; EB9C: 5C        ;  
     606/    EB9D : 80 16                               SUBA    #$16                     ; EB9D: 80 16     ;  
     607/    EB9F : 24 FB                               BCC     IEB9C                    ; EB9F: 24 FB     ;  
     608/    EBA1 : D7 19                               STAB    CLKFREQ                  ; EBA1: D7 19     ; B is 3 for 1MHz
     609/    EBA3 : 7E E9 91                            JMP     ERRHNDLR   ; -->         ; EBA3: 7E E9 91  ; ERRHNDLR has RTS
     610/    EBA6 :                     ;------------------------------------------------
     611/    EBA6 : BD E8 22            FDINIT3         JSR     FDINIT                   ; EBA6: BD E8 22  ; 
     612/    EBA9 : 7E E8 87                            JMP     CLOCK                    ; EBA9: 7E E8 87  ; initializes and starts drive, then jumps to CLKDMD
     613/    EBAC :                     ;------------------------------------------------
     614/    EBAC : 36                  ZEBAC           PSHA                             ; EBAC: 36        ; 
     615/    EBAD : F6 EC 26            ZEBAD           LDAB    MEC26                    ; EBAD: F6 EC 26  ; <------------------------------------ no RAM here!
     616/    EBB0 : C5 01                               BITB    #$01                     ; EBB0: C5 01     ; 
     617/    EBB2 : 27 26                               BEQ     ZEBDA                    ; EBB2: 27 26     ; 
     618/    EBB4 : B6 EC 27                            LDAA    MEC27                    ; EBB4: B6 EC 27  ; <------------------------------------ no RAM here!
     619/    EBB7 : 81 13                               CMPA    #$13                     ; EBB7: 81 13     ; 
     620/    EBB9 : 26 1F                               BNE     ZEBDA                    ; EBB9: 26 1F     ; 
     621/    EBBB : F6 EC 26            ZEBBB           LDAB    MEC26                    ; EBBB: F6 EC 26  ; <------------------------------------ no RAM here!
     622/    EBBE : 20 0F                               BRA     ZEBCF                    ; EBBE: 20 0F     ; 
     623/    EBC0 :                     ;------------------------------------------------
     624/    EBC0 :                     ;LPINIT
     625/    EBC0 : 86 03                               LDAA    #$03                     ; EBC0: 86 03     ; 
     626/    EBC2 : B7 EC 26                            STAA    MEC26                    ; EBC2: B7 EC 26  ; <------------------------------------ no RAM here!
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 19 - 2026-01-23 11:21:24


     627/    EBC5 : 86 15                               LDAA    #$15                     ; EBC5: 86 15     ; 
     628/    EBC7 : B7 EC 26                            STAA    MEC26                    ; EBC7: B7 EC 26  ; <------------------------------------ no RAM here! 
     629/    EBCA : 39                                  RTS                              ; EBCA: 39        ; 
     630/    EBCB :                     ;------------------------------------------------
     631/    EBCB : 01                                  NOP                              ; EBCB: 01        ; 
     632/    EBCC :                     ;LIST
     633/    EBCC : 37                                  PSHB                             ; EBCC: 37        ; 
     634/    EBCD : 20 DD                               BRA     ZEBAC                    ; EBCD: 20 DD     ; 
     635/    EBCF :                     ;------------------------------------------------
     636/    EBCF : C5 01               ZEBCF           BITB    #$01                     ; EBCF: C5 01     ; 
     637/    EBD1 : 27 E8                               BEQ     ZEBBB                    ; EBD1: 27 E8     ; 
     638/    EBD3 : B6 EC 27                            LDAA    MEC27                    ; EBD3: B6 EC 27  ; <------------------------------------ no RAM here!
     639/    EBD6 : 81 11                               CMPA    #$11                     ; EBD6: 81 11     ; 
     640/    EBD8 : 26 E1                               BNE     ZEBBB                    ; EBD8: 26 E1     ; 
     641/    EBDA : C5 02               ZEBDA           BITB    #$02                     ; EBDA: C5 02     ; 
     642/    EBDC : 27 CF                               BEQ     ZEBAD                    ; EBDC: 27 CF     ; 
     643/    EBDE : 32                                  PULA                             ; EBDE: 32        ; 
     644/    EBDF : B7 EC 27                            STAA    MEC27                    ; EBDF: B7 EC 27  ; <------------------------------------ no RAM here!
     645/    EBE2 : 33                                  PULB                             ; EBE2: 33        ; 
     646/    EBE3 : 39                                  RTS                              ; EBE3: 39        ; 
     647/    EBE4 :                     ;------------------------------------------------
     648/    EBE4 : 86 0D               LDATA0          LDAA    #$0D                     ; EBE4: 86 0D     ; Send String to Printer
     649/    EBE6 : 8D E4                               BSR     LIST                     ; EBE6: 8D E4     ; 
     650/    EBE8 : 09                                  DEX                              ; EBE8: 09        ; 
     651/    EBE9 : 86 0A                               LDAA    #$0A                     ; EBE9: 86 0A     ; 
     652/    EBEB : 20 02                               BRA     ZEBEF                    ; EBEB: 20 02     ; 
     653/    EBED :                     ;------------------------------------------------
     654/    EBED : 01                                  NOP                              ; EBED: 01        ; 
     655/    EBEE : 01                                  NOP                              ; EBEE: 01        ; 
     656/    EBEF : 8D DB               ZEBEF           BSR     LIST                     ; EBEF: 8D DB     ; 
     657/    EBF1 : 08                                  INX                              ; EBF1: 08        ; 
     658/    EBF2 : A6 00                               LDAA    ,X                       ; EBF2: A6 00     ; 
     659/    EBF4 : 81 04                               CMPA    #$04                     ; EBF4: 81 04     ; End of line ?
     660/    EBF6 : 26 F7                               BNE     ZEBEF                    ; EBF6: 26 F7     ; 
     661/    EBF8 : 86 1B                               LDAA    #$1B                     ; EBF8: 86 1B     ; 
     662/    EBFA : 8D D0                               BSR     LIST                     ; EBFA: 8D D0     ; 
     663/    EBFC : 39                                  RTS                              ; EBFC: 39        ; 
     664/    EBFD :                     ;------------------------------------------------
     665/    EBFD : 00                                  FCB     $00                      ; EBFD: 00             
     666/    EBFE : 00                                  FCB     $00                      ; EBFE: 00             
     667/    EBFF : 00                                  FCB     $00                      ; EBFF: 00             
     668/    EC00 :                     
     669/    EC00 :                     
     670/    EC00 :                                     END
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 20 - 2026-01-23 11:21:24


  Symbol Table (* = unused):
  --------------------------

*ACK :                            6 - | *ADAX1 :                         28 - |
*ADBX1 :                         27 - | *ADDAM1 :                        16 - |
*ADDAX1 :                        29 - |  ADDRMRK :                       14 - |
*ADXBA1 :                        2A - | *AECHO :                       FF53 - |
*ALLOC1 :                        21 - | *ALPHA1 :                        14 - |
*ALUSM1 :                        1E - |
*ARCHITECTURE :                                      "x86_64-unknown-linux" - |
*ASLX1 :                         31 - | *ASRX1 :                         30 - |
*BEL :                            7 - | *BIGENDIAN :                      0 - |
*BKPINS :                      FF4F - | *BOOT1 :                         3F - |
*BRANCHEXT :                      0 - | *BRKPES :                      FF63 - |
*BRKPTS :                      FF1F - | *BS :                             8 - |
*CAN :                           18 - | *CASESENSITIVE :                  0 - |
 CBUFFS :                        AE - |  CBUFLS :                        50 - |
*CBUFPS :                        FE - | *CDBDDA :                         8 - |
*CDBDDF :                         6 - | *CDBHAD :                         4 - |
*CDBIOC :                         0 - | *CDBLEN :                         C - |
*CDBSDA :                         2 - | *CDBVDT :                         7 - |
 CDBWST :                         A - | *CHANG1 :                        1F - |
 CHFLGS :                       11E - |  CHKERR :                      E853 - |
*CKBRK1 :                         D - |  CLKDMD :                      EB85 C |
 CLKFREQ :                       19 - |  CLOCK :                       E887 C |
 CLOCKN :                      E8D2 C | *CLOSE1 :                         3 - |
 CLRTOP :                      EB90 C | *CMPAR1 :                        11 - |
*CNACIS :                      FCF4 - | *COMPMODE :                       0 - |
*CONSTPI :        3.141592653589793 - | *CPBAX1 :                        2F - |
*CR :                             D - |  CRCOK :                       EACD C |
 CRCONLY :                     EABB C | *CURADR :                         6 - |
 CURADRH :                        6 - |  CURDRV :                         0 - |
*CUSTOM :                         0 - |  CWRDCNT :                        9 - |
*DATE :                "2026-01-23" - | *DC1 :                           11 - |
*DC2 :                           12 - | *DC3 :                           13 - |
*DC4 :                           14 - | *DDSCNS :                         4 - |
*DDSFMC :                         1 - | *DDSINP :                        20 - |
*DDSLOG :                         2 - | *DDSOCF :                        10 - |
*DDSOUT :                        40 - | *DDSRES :                        80 - |
*DDSRWD :                         8 - | *DEALC1 :                        22 - |
*DEVDLM :                       '#' - | *DFCLSS :                        20 - |
*DIDSDT :                         C - | *DIDSID :                         0 - |
*DIDSNM :                        12 - | *DIDSRB :                        26 - |
*DIDSRN :                         A - | *DIDSVN :                         8 - |
*DIRSAT :                         C - | *DIRSM1 :                        1C - |
*DIRSNM :                         0 - | *DIRSNU :                         E - |
*DIRSRB :                         A - | *DIRSSX :                         8 - |
*DLE :                           10 - | *DMA1 :                          19 - |
 DRDCNT :                        18 - | *DREAD1 :                         E - |
*DRVDLM :                       ':' - |  DRVRDY :                      E8C2 C |
*DSLOAD :                      E800 - | *DSPLX1 :                         B - |
*DSPLY1 :                         A - | *DSPLZ1 :                         C - |
*DTSCLS :                        10 - | *DTSINP :                        80 - |
*DTSNFF :                         4 - | *DTSOPI :                         1 - |
*DTSOPO :                         2 - | *DTSOPP :                         0 - |
*DTSOPU :                         3 - | *DTSOUT :                        40 - |
*DTSSIO :                        20 - | *DTSTRU :                         8 - |
*DVSINT :                         6 - | *DVSIO :                          C - |
*DVSOFF :                         3 - | *DVSON :                          0 - |
*DVSTRM :                         9 - |  DWRDCNT :                       15 - |
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 21 - 2026-01-23 11:21:24


*DWRIT1 :                         F - | *EDT :                            4 - |
*EM :                            19 - |  ENDOSS :                       106 - |
 ENDRVS :                       110 - |  ENDSYS :                       10A - |
 ENDUSS :                       108 - | *ENG :                            5 - |
*EREAD1 :                        39 - |  ERRHNDLR :                    E991 C |
*ERSACR :                       '9' - | *ERSCRC :                       '1' - |
*ERSDAD :                       '6' - | *ERSDMA :                       '8' - |
*ERSMRK :                       '4' - | *ERSRDY :                       '3' - |
*ERSSEK :                       '7' - | *ERSTIM :                       '5' - |
*ERSWRT :                       '2' - | *ESC :                           1B - |
*ETB :                           17 - | *ETX :                            3 - |
*EWORD1 :                        23 - | *EWRIT1 :                        3A - |
*EXADDR :                        22 - | *FALSE :                          0 - |
*FAMDLM :                       '*' - |  FDINIT :                      E822 - |
 FDINIT2 :                     E850 C |  FDINIT3 :                     EBA6 C |
*FDSCMP :                         8 - | *FDSCON :                        10 - |
*FDSDEL :                        40 - | *FDSFMA :                         5 - |
*FDSFMB :                         3 - | *FDSFMC :                         7 - |
*FDSFMD :                         1 - | *FDSFML :                         2 - |
*FDSFMU :                         0 - | *FDSSYS :                        20 - |
 FDSTAT :                         8 - | *FDSWRT :                        80 - |
*FF :                             C - | *FS :                            1C - |
*FULLPMMU :                       1 - |  FUNCSAV :                        E - |
 GDBAS :                        112 - | *GETFD1 :                        36 - |
*GETLS1 :                         7 - | *GETRC1 :                         4 - |
*GS :                            1D - | *HAS64 :                          1 - |
*HASDSP :                         0 - | *HASFPU :                         0 - |
*HASPMMU :                        0 - | *HT :                             9 - |
 IE84F :                       E84F C |  IE866 :                       E866 C |
 IE8AD :                       E8AD C |  IE8EA :                       E8EA C |
 IE8FB :                       E8FB C |  IE917 :                       E917 C |
 IE91F :                       E91F C |  IE961 :                       E961 C |
 IE980 :                       E980 C |  IE9A5 :                       E9A5 C |
 IE9F2 :                       E9F2 C |  IEA0C :                       EA0C C |
 IEA1A :                       EA1A C |  IEA1C :                       EA1C C |
 IEA26 :                       EA26 C |  IEA32 :                       EA32 C |
 IEA3E :                       EA3E C |  IEA46 :                       EA46 C |
 IEA52 :                       EA52 C |  IEA64 :                       EA64 C |
 IEA6B :                       EA6B C |  IEA70 :                       EA70 C |
 IEA9A :                       EA9A C |  IEAA4 :                       EAA4 C |
 IEACF :                       EACF C |  IEB07 :                       EB07 C |
 IEB11 :                       EB11 C |  IEB2A :                       EB2A C |
 IEB2C :                       EB2C C |  IEB43 :                       EB43 C |
 IEB4D :                       EB4D C |  IEB53 :                       EB53 C |
 IEB5D :                       EB5D C |  IEB67 :                       EB67 C |
 IEB8A :                       EB8A C |  IEB91 :                       EB91 C |
 IEB9C :                       EB9C C | *INCHNP :                      F015 - |
 INCTRK :                      E9CA C | *INEXTMODE :                      0 - |
*INLWORDMODE :                    0 - | *INMAXMODE :                      0 - |
*INSRCMODE :                      0 - | *INSUPMODE :                      0 - |
 IOCBLN :                        25 - | *IOCDBP :                         2 - |
*IOCDBS :                         4 - | *IOCDEN :                        1B - |
*IOCDTT :                         1 - | *IOCEOF :                        13 - |
*IOCFDF :                        17 - | *IOCGDW :                         8 - |
*IOCLSN :                        11 - | *IOCLUN :                         A - |
*IOCMLS :                         B - | *IOCNAM :                         B - |
*IOCRIB :                        15 - | *IOCSBE :                        21 - |
 IOCSBI :                        23 - | *IOCSBP :                        1D - |
*IOCSBS :                        1F - | *IOCSDW :                         D - |
*IOCSLS :                         F - |  IOCSTA :                         0 - |
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 22 - 2026-01-23 11:21:24


*IOCSUF :                        13 - |  IRGSSV :                       11C - |
 IRGSUV :                       11A - | *IRGSVC :                      FFF8 - |
*ISBUFQ :                         D - | *ISCKSM :                         E - |
*ISCLOS :                         8 - | *ISDEAL :                        17 - |
*ISDELT :                        10 - | *ISDSPC :                        13 - |
*ISDTYP :                         B - | *ISDUPE :                         6 - |
*ISEOF :                          9 - | *ISEOM :                          C - |
*ISFSPC :                        12 - | *ISFTYP :                         A - |
*ISIDEN :                        15 - | *ISIVDV :                         5 - |
*ISNODV :                         1 - | *ISNOER :                         0 - |
*ISNONM :                         7 - | *ISNORV :                         3 - |
*ISNRDY :                         4 - | *ISRANG :                        11 - |
*ISRECL :                        18 - | *ISRES :                          2 - |
*ISRIB :                         16 - | *ISSECB :                        19 - |
*ISSSPC :                        14 - | *ISWRIT :                         F - |
*JOCDBE :                         6 - | *KEYIN1 :                         9 - |
 KYISSV :                       104 - |  LDADDR :                        20 - |
*LDATA :                       EBE4 - | *LDATA0 :                      EBE4 C |
*LDATA1 :                      EBF2 - | *LF :                             A - |
 LIST :                        EBCC - | *LISTON :                         1 - |
*LOAD1 :                         1B - | *LPINIT :                      EBC0 - |
 LSCTLN :                         5 - | *LUSRES :                        40 - |
 M0012 :                         12 - | *MACEXP :                         7 - |
*MAIDS :                       F0F3 - | *MDENT1 :                        1A - |
*MDERR1 :                        20 - |  MDOSS :                        100 - |
 MEC26 :                       EC26 - |  MEC27 :                       EC27 - |
*MERED1 :                        3D - | *MEWRT1 :                        3E - |
*MMA1 :                          18 - | *MOMCPU :                      6800 - |
*MOMCPUNAME :                "6800" - | *MOVE1 :                         10 - |
*MREAD1 :                        3B - | *MWRIT1 :                        3C - |
*NAK :                           15 - | *NESTMAX :                      100 - |
 NMIISR :                      E939 C |  NMISVC :                      FFFC - |
 NMIVECSAV :                      F - |  NOCRC :                       E9FB C |
*NULL :                           0 - | *NUMD1 :                         15 - |
*NUMSCT :                         3 - |  NUMSCTH :                        3 - |
 NUMSCTL :                        4 - |  NXTSEC :                      E9D3 C |
*ONECON :                        24 - | *OPEN1 :                          2 - |
*OPTDLM :                       ';' - | *OSLOAD :                      E800 C |
*OUTCH :                       F018 - | *PACKING :                        0 - |
*PADDING :                        0 - | *PCRLF :                       F021 - |
*PDATA :                       F024 - | *PFNAM1 :                        1D - |
 PIACTRL :                     EC02 - |  PIAREGA :                     EC00 - |
 PIAREGB :                     EC01 - | *PRINT1 :                        34 - |
*PRINX1 :                        35 - |  PRNTER :                      E85A - |
 PROM_0 :                      FCFC - | *PSHX1 :                         32 - |
*PULX1 :                         33 - | *PUTEF1 :                        38 - |
*PUTFD1 :                        37 - | *PUTLS1 :                         8 - |
*PUTRC1 :                         5 - | *PWRUP :                       F000 - |
*RDCRC :                       E86F - |  READCRC :                     EABD C |
 READINIT :                    E9AC C | *READPS :                      E86D - |
 READSC :                      E869 - |  READSECT :                    EA9D C |
 REENT2 :                      F564 - | *RELAXED :                        0 - |
*RELES1 :                         1 - | *RESRV1 :                         0 - |
 RESTOR :                      E875 - |  RESTORN :                     E8CB C |
 RESTORY :                     E90A C |  RETRG :                       EB74 C |
*RETRYS :                         5 - |  REVSSS :                       102 - |
*REWND1 :                         6 - |  RIBBAS :                       10E - |
*RIBSLA :                        78 - | *RIBSLB :                        75 - |
*RIBSSA :                        7A - | *RIBSSL :                        76 - |
*RS :                            1E - | *RUBOUT :                        7F - |
 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 23 - 2026-01-23 11:21:24


*RWTEST :                      E872 - | *SBITS :                       FCFD - |
*SCSBB :                         17 - | *SCSCAT :                         1 - |
*SCSCLS :                         4 - | *SCSDID :                         0 - |
*SCSDIR :                         3 - | *SCSDOS :                        18 - |
*SCSDRE :                        16 - | *SCSLOK :                         2 - |
*SCSMAX :                       7D0 - | *SCSMXD :                       FA4 - |
*SCSSIZ :                        80 - | *SCSTKD :                        34 - |
*SCSTRK :                        1A - | *SCTCNT :                         B - |
 SECRDDONE :                   E984 C |  SECTCNT :                        B - |
*SEEK :                        E878 - |  SERR1 :                       EA86 C |
 SERR2 :                       EA95 C |  SERR3 :                       E8BB C |
 SERR4 :                       EA98 C |  SERR6 :                       E8BE C |
 SERR7 :                       E93E C |  SERR9 :                       EA89 C |
 SETERR :                      E940 C | *SI :                             F - |
*SIDES :                          D - | *SO :                             E - |
 SOFTRK :                         A - | *SOH :                            1 - |
*SPACE :                         20 - |  SSDA_0 :                      EC04 - |
 SSDA_1 :                      EC05 - |  STACKSAV :                      16 - |
 START :                       E9E5 C |  STATSAV :                        D - |
*STCHB1 :                        12 - | *STCHR1 :                        13 - |
 STEP :                        E946 C | *STRSCT :                         1 - |
 STRSCTH :                        1 - |  STRSCTL :                        2 - |
*STX :                            2 - | *SUAX1 :                         2C - |
*SUB :                           1A - | *SUBAM1 :                        17 - |
*SUBAX1 :                        2D - | *SUBX1 :                         2B - |
*SUFDLM :                       '.' - | *SUXBA1 :                        2E - |
 SWISSV :                       116 - |  SWISUV :                       118 - |
*SWISVC :                      FFFA - | *SYEOCB :                       16A - |
 SYERRS :                       114 - |  SYIOCB :                       120 - |
*SYN :                           16 - |  SYPOCB :                       145 - |
*TBAX1 :                         25 - | *TIME :                  "11:21:24" - |
 TRACKSAV :                      13 - | *TRUE :                           1 - |
*TXBA1 :                         24 - | *US :                            1F - |
*VDSBIN :                         4 - | *VDSGDB :                         8 - |
*VDSNFF :                        80 - | *VDSSDA :                        10 - |
*VERSION :                     142F - |  VERSSS :                       100 - |
*VT :                             B - |  WAIT1 :                       E955 C |
 WAIT2 :                       E95C C |  WAIT3 :                       E953 C |
*WRDDAM :                      E87E - |  WRITINIT :                    EADD C |
*WRITSC :                      E884 - |  WRITSEC :                     EB31 C |
*WRTEST :                      E87B - | *WRVERF :                      E881 - |
*XBAX1 :                         26 - |  XOUTCH :                      F018 - |
*XREGSA :                      FF1A - | *XREGSB :                      FF1B - |
*XREGSC :                      FF1C - | *XREGSP :                      FF16 - |
*XREGSS :                      FF1D - | *XREGSX :                      FF18 - |
 XSTAKS :                      FF8A - | *Z80SYNTAX :                      0 - |
 ZE96A :                       E96A C |  ZEBAC :                       EBAC C |
 ZEBAD :                       EBAD C |  ZEBBB :                       EBBB C |
 ZEBCF :                       EBCF C |  ZEBDA :                       EBDA C |
 ZEBEF :                       EBEF C |

    451 symbols
    307 unused symbols

 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 24 - 2026-01-23 11:21:24


  Defined Macros:
  ---------------

SCALL                                 | SKIP1                                
SKIP2                                 |

      3 macros

 AS V1.42 Beta [Bld 216] - Source File floppy2_commented.asm - Page 25 - 2026-01-23 11:21:24


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.02 seconds assembly time

   1125 lines source file
      2 passes
      0 errors
      0 warnings
